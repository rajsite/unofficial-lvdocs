<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
      <link rel="stylesheet" type="text/css" href="htmlhelp_base.css">
      <title>The Finite Element Method for the Variational Problem</title><script src="jQuery-1.7.2.min.js" type="text/javascript" xml:space="preserve"></script><script src="linking.js" type="text/javascript" xml:space="preserve"></script><script type="text/javascript" xml:space="preserve">
		var fbProductDNA=2543;
		var fbVersionName="2012";
		</script><script src="feedbacklink1.0.js" type="text/javascript" xml:space="preserve"></script></head>
   <body><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76" shape="rect">
         <!-- --></a> 
      
      <h1 class="topictitle1">The Finite Element Method for the Variational Problem</h1> 
      
      <div> 
         	 
         <p>The finite element method does not apply to the PDE directly, but it applies to the following equivalent variational problem
            by Green's identity, as shown in the following equation: 
            	 
         </p> 
         <div class="fignone">
            <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e15.png"></span></div>
         </div> 
         	 
         <p>for any function <em>v</em>(<em>x</em>, <em>y</em>) &#8712; <em>H</em><sub>0</sub><sup>1</sup>(&#937;). 
            	 
         </p> 
         	 
         <p>In this function, <em>H</em><sub>0</sub><sup>1</sup>(&#937;) denotes the space that consists of all functions, which are continuous on &#937; and vanish on the boundary. The identity satisfies
            this function because the values of <em>v</em> are zeros on the boundary. 
            	 
         </p> 
         	 
         <p>The equivalent variational problem is known as the weak formula. The finite element method calculates the weak solution, which
            is the solution of the weak formula. Mathematically, find <em>u</em>(<em>x</em>, <em>y</em>) &#8712; <em>H</em><sub>0</sub><sup>1</sup>(&#937;) such that any function <em>v</em>(<em>x</em>, <em>y</em>) &#8712; <em>H</em><sub>0</sub><sup>1</sup>(&#937;) satisfies the weak formula. The weak solution approximates the solution of the original PDE. 
            	 
         </p> 
         	 
         <p>Use the following steps to solve the equation numerically with the finite element method. 
            	 
         </p> 
         	 
         <div class="section"><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__SECTION_60FCAC6D4B8C435CBFFC4FCF49FBC6B5" shape="rect">
               <!-- --></a><h2 class="sectiontitle">Step One</h2> 
            		 
            		
            <p>Construct a finite dimensional subspace of <em>H</em><sub>0</sub><sup>1</sup>(&#937;) and determine its basis. Usually, the piecewise polynomial functions become the basis functions. 
               		
            </p> 
            		
            <p>For example, the basis functions are &#936; = {&#936;1, ..., &#936;<sub><em>n</em></sub>} where &#936;<sub><em>i</em></sub> is the basis function that corresponds to the <em>i</em>th grid point. 
               		
            </p> 
            		
            <table>
               <tr>
                  <td><img alt="Note" src="note.gif"></td>
                  <td><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__GUID-E2EAD77A-E239-486A-8279-DF13917C3785" shape="rect">
                        <!-- --></a><span class="notetitle">Note&nbsp;&nbsp;</span> &#936;<sub><em>i</em></sub> is non-zero only on the elements that are adjacent to the <em>i</em>th grid point. 
                     		
                  </td>
               </tr>
            </table> 
            		
            <p>Given the set of basis functions, approximate the unknown function <em>u</em> in the finite dimensional subspace with the following equation: 
               		
            </p> 
            <div class="fignone">
               <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e424.png"></span></div>
            </div> 
            		
            <p>where <em>u</em><sub><em>i</em></sub> is the unknown value of <em>u</em> on the <em>i</em>th grid point. 
               		
            </p> 
            		
            <p>You also can approximate the right side of the equation with the following equation 
               		
            </p> 
            <div class="fignone">
               <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e482.png"></span></div>
            </div> 
            		
            <p>where <em>f</em><sub><em>i</em></sub> is the value of the right side of the equation evaluated on the <em>i</em>th grid point. 
               		
            </p> 
            		
            <p>High order polynomial functions often result in better approximation. 
               		
            </p> 
            	 
         </div> 
         	 
         <div class="section"><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__SECTION_5A4579F1F7EF4F969EE028A6A531CF57" shape="rect">
               <!-- --></a><h2 class="sectiontitle">Step Two</h2> 
            		 
            		
            <p>Replace <em>v</em> with the basis functions in the variational formula. All basis functions satisfy the following equation: 
               		
            </p> 
            <div class="fignone">
               <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e549.png"></span></div>
            </div> 
            		
            <p>Formulate the matrix form of the variational problem by combining all the equations of -<em>K</em><em>U</em> = <em>M</em><em>F</em> where <em>U</em><sup>T</sup> = (<em>u</em><sub>1</sub>, ..., <em>u</em><sub><em>n</em></sub>)<sup>T</sup> represents the unknown values and <em>F</em><sup>T</sup> = (<em>f</em><sub>1</sub>, ..., <em>f</em><sub><em>n</em></sub>)<sup>T</sup> represents the right side. The <em>i</em><em>j</em>th element in <em>K</em> and <em>M</em> is defined as shown in the following equations: 
               		
            </p> 
            <div class="fignone">
               <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e921.png"></span></div>
            </div>
            <div class="fignone">
               <div class="mathml-block"><span><img src="./vac_fem_variational_problem.xml_d14801e1026.png"></span></div>
            </div> 
            		
            <p> <em>K</em> and <em>M</em> often refer to the stiffness and mass matrices, respectively. 
               		
            </p> 
            		
            <table>
               <tr>
                  <td><img alt="Note" src="note.gif"></td>
                  <td><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__GUID-867ADDBC-006A-4CC5-80D0-99559DB47B62" shape="rect">
                        <!-- --></a><span class="notetitle">Note&nbsp;&nbsp;</span> The stiffness and mass matrices are symmetrical and positive definite for the Poisson equation. 
                     		
                  </td>
               </tr>
            </table> 
            		
            <p>If the unknown function does not vanish on the boundary, compensate for the effect of the boundary condition on the right
               side of the matrix form. However, the non-zero boundary condition does not affect the stiffness and mass matrices. 
               		
            </p> 
            	 
         </div> 
         	 
         <div class="section"><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__SECTION_E18BD4FD20E3477F832D09714F87E90D" shape="rect">
               <!-- --></a><h2 class="sectiontitle">Step Three</h2> 
            		 
            		
            <p> Assemble the stiffness and mass matrices. <em>K</em><sub><em>i</em><em>j</em></sub> or <em>M</em><sub><em>i</em><em>j</em></sub> are non-zero only when the <em>i</em>th and <em>j</em>th grid points belong to the same element. Therefore, assemble the integration by summing its constituent parts on each element.
               In computer implementation, relate each element to a reference element with affine mapping. The basis functions on each element
               are further fixed to a set of basis functions on the reference element. Calculate the integration over the reference element
               and assemble the value of each element with the stiffness and mass matrices. 
               		
            </p> 
            	 
         </div> 
         	 
         <div class="section"><a name="GUID-170D8049-7CAC-4554-8E3D-BAA74277DA76__SECTION_53AC717EDAD5430591BFF9B4069F4120" shape="rect">
               <!-- --></a><h2 class="sectiontitle">Step Four</h2> 
            		 
            		
            <p>Solve the matrix form of the variational problem to get the solution of the original PDE. Because most of the elements of
               the stiffness and mass matrices are zeros, the matrices are usually sparse and might not have a special structure. The number
               of grid points determines the order of the stiffness and mass matrices. With a large number of grid points, you need to solve
               a large sparse linear equation. The iterative solvers, which require only matrix-vector multiplication, solve the large linear
               equation. 
               		
            </p> 
            	 
         </div> 
         
      </div> 
      
      <div>
         <div class="familylinks">
            <div class="parentlink"><strong>Parent topic:</strong> <a href="lvac_finite_element_method.html" shape="rect">The Finite Element Method</a></div>
         </div>
      </div>
      
   </body>
</html>