<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><head><!--Generated from database. Edit in the database; do not edit this file.--><!--Function id="623"--><TITLE>VISA Find Resource Function</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="STYLESHEET" type="text/css" href="minimal.css"><script src="common.js" type="text/javascript"></script><script src="jquery-1.7.2.min.js" type="text/javascript"></script><script src="cssframes.js" type="text/javascript"></script><link media="print" rel="stylesheet" type="text/css" href="print.css"></head><body bgcolor="#ffffff"><noscript><p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p><hr width="100%" noshade></noscript><div id="styleDivTitle"><!-- VI or Function Name --><H1>VISA Find Resource Function</H1><!--Owning Palette--><p class="Body"><strong>Owning Palette:</strong> <a href="../lvinstio/VISA_Advanced_Subpalette.html">VISA Advanced VIs and Functions</a></p><!--Package and Platform--><p class="Body"><strong>Requires:</strong> Base Development System</p><!-- VI/Function Description --><p class="Body">Queries the system to locate the devices associated with a specified interface.</p><!-- Supplemental VI/Function Information --><!-- Link to Additional VI/Function Information and Examples  --><p class="Body"><a href="#details">Details</a>&nbsp;&nbsp;</p><!-- Graphic Reference --><MAP NAME="connector_pane"><AREA SHAPE="rect" COORDS="0,12,99,23" HREF="#Input0"><AREA SHAPE="rect" COORDS="0,26,99,37" HREF="#Input1"><AREA SHAPE="rect" COORDS="0,40,99,51" HREF="#Input2"><AREA SHAPE="rect" COORDS="212,12,247,21" HREF="#Output0"><AREA SHAPE="rect" COORDS="212,27,273,35" HREF="#Output1"><AREA SHAPE="rect" COORDS="212,41,256,49" HREF="#Output2"></MAP><p class="Anchor"><img src="visafnd.gif" usemap="#connector_pane" border="0"></p><!--Add/Find Buttons--><table class="Borderless"><tr><td><a href="javascript:placeObject(object623);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add to the block diagram</td><td><a href="javascript:findObject(object623);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find on the palette</td></tr></table></div><div id="styleDivScrolling"><!-- Table of VI/Function Parameters --><table class="Borderless"><tr><td class="Icon"><a name="Input0"></a><img src="cstr.gif"></td><td><strong>expression</strong> matches the value specified with the devices available for a particular interface. The description string specified sets the criteria to search an interface&#8212;GPIB, GPIB-VXI, VXI, All VXI, Serial, or All&#8212;for existing devices. The following table includes valid special characters and operators.<table class="Bordered"><tr><th class="Bordered">Special Characters and Operators</th><th class="Bordered">Meaning</th></tr><tr><td class="Bordered"><span class="Monospace">?</span></td><td class="Bordered">Matches any one character.</td></tr><tr><td class="Bordered"><span class="Monospace">\</span></td><td class="Bordered">Makes the character that follows it an ordinary character instead of special character. For example, when a question mark follows a backslash (\?), it matches the ? character instead of any one character.</td></tr><tr><td class="Bordered"><span class="Monospace">[list]</span></td><td class="Bordered">Matches any one character from the enclosed list. You can use a hyphen to match a range of characters.</td></tr><tr><td class="Bordered"><span class="Monospace">[^list]</span></td><td class="Bordered">Matches any character not in the enclosed list. You can use a hyphen to match a range of characters.</td></tr><tr><td class="Bordered"><span class="Monospace">*</span></td><td class="Bordered">Matches 0 or more occurrences of the preceding character or expression.</td></tr><tr><td class="Bordered"><span class="Monospace">+</span></td><td class="Bordered">Matches 1 or more occurrences of the preceding character or expression.</td></tr><tr><td class="Bordered"><span class="Monospace">Exp|exp</span></td><td class="Bordered">Matches either the preceding or following expression. The or operator | matches the entire expression that precedes or follows it and not just the character that precedes or follows it. For example, VXI|GPIB means (VXI)|(GPIB), not VX(I|G)PIB.</td></tr><tr><td class="Bordered"><span class="Monospace">(exp)</span></td><td class="Bordered">Grouping characters or expressions.</td></tr></table>The search criteria specified in the <strong>expression</strong> parameter has two parts, a regular expression over a resource string and an optional logical expression over attribute values. The regular expression is matched against the resource strings of resources known to the VISA Resource Manager. If the resource string matches the regular expression, the attribute values of the resource are matched against the expression over attribute values. If the match is successful, the resource has met the search criteria and is added to the list of resources found. The following table includes valid regular expressions.<table class="Bordered"><tr><th class="Bordered">Regular Expression</th><th class="Bordered">Sample Matches</th></tr><tr><td class="Bordered"><span class="Monospace">GPIB?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB0::2::INSTR</span>, <span class="Monospace">GPIB1::1::1::INSTR</span>, and <span class="Monospace">GPIB-VXI1::8::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">GPIB[0-9]*::?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB0::2::INSTR</span> and <span class="Monospace">GPIB1::1::1::INSTR</span> but not <span class="Monospace">GPIB-VXI1::8::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">GPIB[^0]::?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB1::1::1::INSTR</span> but not <span class="Monospace">GPIB0::2::INSTR</span> or <span class="Monospace">GPIB12::8::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">VXI?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">VXI0::1::INSTR</span> but not <span class="Monospace">GPIB-VXI0::1::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">GPIB-VXI?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB-VXI0::1::INSTR</span> but not <span class="Monospace">VXI0::1::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">?*VXI[0-9]*::?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">VXI0::1::INSTR</span> and <span class="Monospace">GPIB-VXI0::1::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">ASRL[0-9]*::?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">ASRL1::INSTR</span> but not <span class="Monospace">VXI0::5::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">ASRL1+::INSTR</span></td><td class="Bordered">Matches <span class="Monospace">ASRL1::INSTR</span> and <span class="Monospace">ASRL11::INSTR</span> but not <span class="Monospace">ASRL2::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">(GPIB|VXI)?*INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB1::5::INSTR</span> and <span class="Monospace">VXI0::3::INSTR</span> but not <span class="Monospace">ASRL2::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">(GPIB0|VXI0)::1::INSTR</span></td><td class="Bordered">Matches <span class="Monospace">GPIB0::1::INSTR</span> and <span class="Monospace">VXI0::1::INSTR</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">?*INSTR</span></td><td class="Bordered">Matches all INSTR (device) resources.</td></tr><tr><td class="Bordered"><span class="Monospace">?*VXI[0-9]*::?*MEMACC</span></td><td class="Bordered">Matches <span class="Monospace">VXI0::MEMACC</span> and <span class="Monospace">GPIB-VXI1::MEMACC</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">VXI0::?*</span></td><td class="Bordered">Matches <span class="Monospace">VXI0::1::INSTR</span>, <span class="Monospace">VXI0::2::INSTR</span>, and <span class="Monospace">VXI0::MEMACC</span>.</td></tr><tr><td class="Bordered"><span class="Monospace">?*</span></td><td class="Bordered">(default) Matches all resources.</td></tr><tr><td class="Bordered"><span class="Monospace">visa://hostname/?*</span></td><td class="Bordered">Matches all resources on the specified remote system. You can set the hostname as either an IP address (dot-notation) or a network machine name. This remote system does not need to be a configured remote system.</td></tr><tr><td class="Bordered"><span class="Monospace">/?*</span></td><td class="Bordered">Matches all resources on the local machine. Does not query configured remote systems.</td></tr><tr><td class="Bordered"><span class="Monospace">visa:/ASRL?*INSTR</span></td><td class="Bordered">Matches all ASRL resources on the local machine and returns them in URL format, such as <span class="Monospace">visa:/ASRL1::INSTR</span>.</td></tr></table>By using the optional attribute expression, you can construct flexible and powerful expressions with the use of logical ANDs (&amp;&amp;), ORs(||), and NOTs (!). You can use equal (==) and unequal (!=) comparators to compare attributes of any data type, and other inequality comparators (&gt;, &lt;, &gt;=, &lt;=) to compare attributes of numeric data type. Use only global attributes in the attribute expression. Local attributes are not allowed in the logical expression part of the expr parameter. The following table includes valid expression parameters.<table class="Bordered"><tr><th class="Bordered">Expr Parameter</th><th class="Bordered">Meaning</th></tr><tr><td class="Bordered"><span class="Monospace">GPIB[0-9]*::?*::?*::INSTR{VI_ATTR_GPIB_SECONDARY_ADDR &gt; 0 &amp;&amp; VI_ATTR_GPIB_SECONDARY_ADDR &lt; 10}</span></td><td class="Bordered">Find all GPIB devices that have secondary addresses from 1 to 9.</td></tr><tr><td class="Bordered"><span class="Monospace">ASRL?*INSTR{VI_ATTR_ASRL_BAUD == 9600}</span></td><td class="Bordered">Find all serial ports configured at 9600 baud.</td></tr><tr><td class="Bordered"><span class="Monospace">?*VXI?INSTR{VI_ATTR_MANF_ID == 0xFF6 &amp;&amp; !(VI_ATTR_VXI_LA ==0 || VI_ATTR_SLOT &lt;= 0)}</span></td><td class="Bordered">Find all VXI instrument resources having manufacturer ID FF6 and which are not logical address 0, slot 0, or external controllers.</td></tr></table></td></tr><tr><td class="Icon"><a name="Input1"></a><img src="cu32.gif"></td><td><strong>search mode</strong> determines how the function returns found interfaces in the <strong>find list</strong> output, either by canonical names or aliases. The default is <span class="Monospace">0</span>.<br> This input accepts the following values.<br><br><table class="Bordered"><tr><td class = "Bordered">0</td><td class = "Bordered"><strong>Canonical Names Only</strong>&#8212;Search all configured buses. Returns only the resources found that match the expression string. The format of each returned string is the VISA canonical spec-defined resource format.</td></tr><tr><td class = "Bordered">2</td><td class = "Bordered"><strong>Aliases Only</strong>&#8212;Search all configured buses. Returns only the resources found that match the expression string. For each resource, if there is a user-defined alias for that resource, that alias is returned. For the other resources, the returned string is in the VISA canonical spec-defined resource format.</td></tr><tr><td class = "Bordered">3</td><td class = "Bordered"><strong>Include Matching Aliases</strong>&#8212;Do not search any buses. Returns only resources with user-defined aliases. The only valid expression string is &quot;?*&quot;. The format of each returned string is an alias.</td></tr><tr><td class = "Bordered">4</td><td class = "Bordered"><strong>Include All Aliases</strong>&#8212;Search all configured buses. Returns all found resources that match the expression string and all user-defined aliases even if they do not match the expression string. For each resource, the function returns a user-defined alias if there is one for that resource. For the other resources, the returned string is in the VISA canonical spec-defined resource format.</td></tr></table></td></tr><tr><td class="Icon"><a name="Input2"></a><img src="cerrcodeclst.gif"></td><td><strong>error in</strong> describes error conditions that occur before this node runs. This input provides <a href="../lvconcepts/using_standard_error_in.html">standard error in</a> functionality. </td></tr><tr><td class="Icon"><a name="Output0"></a><img src="i1dstr.gif"></td><td><strong>find list</strong> is an array of strings, each string specifying one interface found by the function. </td></tr><tr><td class="Icon"><a name="Output1"></a><img src="iu32.gif"></td><td><strong>return count</strong> specifies the number of matches found. The number of matches found is the number of strings in the find list array. </td></tr><tr><td class="Icon"><a name="Output2"></a><img src="ierrcodeclst.gif"></td><td><strong>error out</strong> contains error information. This output provides <a href="../lvconcepts/using_standard_error_out.html">standard error out</a> functionality. </td></tr></table><!-- Additional VI/Function Information --><h2><a name="details">VISA Find Resource Details</a></h2><p class="Body">LabVIEW lists resources in an I/O control according to the chosen I/O control class type and the <strong>Filter VISA Names</strong> dialog box, so you might not need to call this function.</p><p class="Body">All resource strings returned by this function are recognized by <a href="../lvinstio/VISA_Open.html">VISA Open</a>. However, this function does not necessarily return all strings that you pass to the VISA Open function. This is especially true for network and TCP/IP resources. If a resource does not appear in the list, you can explicitly add the resource in the NI-VISA configuration utility, such as <span class="Platform">(Windows)</span> Measurement &amp; Automation Explorer, <span class="Platform">(Linux)</span> visaconf, or <span class="Platform">(Mac OS X)</span> NI-VISA Configuration. The configuration utility also has options that expand or limit the set of resources that this VI returns.</p><!--Module Specific Content--><script type="text/javascript">if (typeof(writeVarRefs)=="function"){writeVarRefs("623");}</script><!-- Example Information --></div></body></HTML>