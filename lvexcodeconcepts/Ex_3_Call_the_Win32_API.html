<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Generated from Shared_Libraries_DLLs.xml. Edit in the XML file; do not edit this file.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Example 3: Call the Win32 API</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script><script src="dynamicjumps.js" type="text/javascript"></script></head>
<body>
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript><a name="Example_3:_Call_the_Win32_API"></a><h1>Example 3: Call the Win32 API</h1>
<p class="Body">
				You might want to access the 32-bit Windows platform API (Win32 API). In Win32 environments, various DLLs permit your application to interact with the operating system and with the graphical user interface. Because the API offers thousands of functions, programmers must rely on the documentation for the Microsoft Software Development Kit (SDK). Microsoft Visual Studio products give you access to the SDK documentation. You also can access this information at the <a href="javascript:WWW(WWW_MSDN)">Microsoft Developer Network (MSDN)</a> website.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="tip.gif"></td>
<td><strong>Tip</strong>��Instead of using the Windows DLL as described in this example, you could easily create this message box in LabVIEW.</td>
</tr>
</table>
<p class="Body">In this example, you call the Windows <span class="Monospace">MessageBox</span> function, a function which illustrates several of the typical complexities of the Win32 API. <span class="Monospace">MessageBox</span> is a simple SDK function that presents a small dialog box with a message, and has the following prototype:</p>
<p class="code"><span class="Monospace">int MessageBox( HWND hWnd, // handle to owner window</span></p>
<p class="code"><span class="Monospace">��������������LPCTSTR lpText, // text in message box</span></p>
<p class="code"><span class="Monospace">��������������LPCTSTR lpCaption, // message box title</span></p>
<p class="code"><span class="Monospace">��������������UINT uType // message box style );</span></p>
<p class="Body">Notice the non-standard data types, such as <span class="Monospace">HWND</span> and <span class="Monospace">LPCTSTR</span>. The Win32 API uses hundreds of data types in the SDK, and very few of them are standard C data types. However, many of the non-standard data types are merely aliases for standard C data types. The API uses the aliases to identify the context of a particular data type. The following table lists the data types in the preceding prototype and the corresponding standard C data types.</p>
<table class="Bordered">
<tr>
<td class="Bordered"><strong>WIN32 SDK Data Type</strong></td>
<td class="Bordered"><strong>Standard C Data Type</strong></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">HWND</span></td>
<td class="Bordered"><span class="Monospace">int **</span></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">LPCTSTR</span></td>
<td class="Bordered"><span class="Monospace">const char *</span></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">UINT</span></td>
<td class="Bordered"><span class="Monospace">unsigned int</span></td>
</tr>
</table>
<p class="Body">To properly call the <span class="Monospace">MessageBox</span> function in 	LabVIEW, you need to identify the equivalent LabVIEW data types, which you can usually infer from the C data types. Mapping <span class="Monospace">LPCTSTR</span> and <span class="Monospace">UINT</span> to LabVIEW is straightforward: <span class="Monospace">LPCTSTR</span> is a C String and <span class="Monospace">UINT</span> is a <span class="Monospace">U32</span>. </p>
<p class="Body">Mapping <span class="Monospace">HWND</span> is more complex. The previous table lists <span class="Monospace">HWND</span> as a double pointer to an integer. However, inspection of the function shows that <span class="Monospace">MessageBox</span> uses <span class="Monospace">HWND</span> merely as a reference number that identifies the owner of the window. Because of this fact, you do not need to know the integer value for which the <span class="Monospace">HWND</span> is a handle. Instead, you need to know the value of the <span class="Monospace">HWND</span> variable itself. Because it is a double pointer, and hence a pointer, you can be treat it as a 32-bit unsigned integer, or in LabVIEW terms, a <span class="Monospace">U32</span>. Handles such as <span class="Monospace">HWND</span> are common in the Win32 SDK. In LabVIEW, you are almost always interested in the handle itself and not the data to which it points. Therefore, you can usually treat handles as <span class="Monospace">U32</span>. Handle names always begin with the letter H in the Win32 API.</p>
<p class="Body">If the SDK documentation does not make clear what C data type corresponds to a Win32 type, search <span class="Monospace">windef.h</span> for the appropriate <span class="Monospace">#define</span> or <span class="Monospace">typedef</span> statement. </p>
<p class="Body">The following table lists the Win32 SDK data types from the previous table and their corresponding LabVIEW data types.</p>
<table class="Bordered">
<tr>
<td class="Bordered"><strong>WIN32 SDK Data Type</strong></td>
<td class="Bordered"><strong>LabVIEW Data Type</strong></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">HWND</span></td>
<td class="Bordered"><span class="Monospace">uInt32</span></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">LPCTSTR</span></td>
<td class="Bordered"><span class="Monospace">CStr (C string pointer)</span></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">UINT</span></td>
<td class="Bordered"><span class="Monospace">uInt32</span></td>
</tr>
</table>
<p class="Body">
				<span class="Platform">(Windows)</span> Refer to the <span class="Monospace">labview\examples\Connectivity\Libraries and Executables\Libraries and Executables.lvproj</span> for a list of more Win32 API data types.</p>
<p class="Body">
				<a href="javascript:openProj('examples%5C%5CConnectivity%5C%5CLibraries%20and%20Executables%5C%5CLibraries%20and%20Executables.lvproj');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a> Open example�
		�<a href="javascript:findExamples(3769);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a> Find related examples
			</p><a name="Constants"></a><h3>Constants</h3>
<p class="Body">This section presents methods for finding the numerical values of constants in the Win32 API, using <span class="Monospace">MessageBox</span> constants as examples.	The following table lists selected constants for <span class="Monospace">MessageBox</span>. </p>
<table class="Bordered">
<tr>
<td class="Bordered"><strong>Constant</strong></td>
<td class="Bordered"><strong>Description</strong></td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">MB_ABORTRETRYIGNORE</span></td>
<td class="Bordered">An Abort, Retry, Ignore message box.</td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">MB_CANCELTRYCONTINUE</span></td>
<td class="Bordered">A Cancel, Try Again, Continue message box on Windows 2000. An alternative to <span class="Monospace">MB_ABORTRETRYIGNORE</span>.</td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">MB_HELP</span></td>
<td class="Bordered">A <strong>Help</strong> button to add to a message box on Windows XP and later. The system sends a <span class="Monospace">WM_HELP</span> message to the owner whenever the user clicks the <strong>Help</strong> button or presses&lt;F1&gt;.</td>
</tr>
<tr>
<td class="Bordered"><span class="Monospace">MB_OK</span></td>
<td class="Bordered">A message box with an <strong>OK</strong> button. This is the default message box.</td>
</tr>
</table>
<p class="Body">In Visual Studio, programmers do not use the actual values of constants. In LabVIEW, however, you need to pass the actual numeric value of the constant to the function. You find these values in the header files that come with the SDK. The SDK documentation normally lists the relevant header file at the bottom of the help topic for a given function. For <span class="Monospace">MessageBox</span>, the SDK documentation specifies the header file as <span class="Monospace">winuser.h</span>.</p>
<p class="Body">The header file named in the preceding statement usually declares the constants. Searching through that header file, you should be able to find a <span class="Monospace">#define</span> statement or an enumeration that assigns the constant text a value. <span class="Monospace">winuser.h</span> defines values for some of the <span class="Monospace">MessageBox</span> constants as follows:</p>
<p class="code"><span class="Monospace">#define MB_OK 0x00000000L</span></p>
<p class="code"><span class="Monospace">#define MB_ABORTRETRYIGNORE 0x00000002L</span></p>
<p class="code"><span class="Monospace">#define MB_ICONWARNING MB_ICONEXCLAMATION</span></p>
<p class="Body">Thus, <span class="Monospace">MB_OK</span> has the decimal value <span class="Monospace">0</span>. <span class="Monospace">MB_ABORTRETRYIGNORE</span> has the decimal value <span class="Monospace">2</span>. <span class="Monospace">MB_ICONWARNING</span> is defined as <span class="Monospace">MB_ICONEXCLAMATION</span>. Elsewhere in <span class="Monospace">winuser.h</span> you find the following statement defining <span class="Monospace">MB_ICONEXCLAMATION</span>:</p>
<p class="code"><span class="Monospace">#define MB_ICONEXCLAMATION 0x00000030L</span></p>
<p class="Body">A hexadecimal value of <span class="Monospace">30</span> translates to a decimal value of <span class="Monospace">48</span>.</p>
<p class="Body">Keep in mind that constants in the SDK often are used in bitfields. A bitfield is usually a single integer in which each bit controls a certain property. The <span class="Monospace">uType</span> parameter in <span class="Monospace">MessageBox</span> is an example of a bitfield. Often, you can combine multiple constants in order to set multiple properties through one parameter. In order to combine these constants, you use a bitwise OR operation ( <span class="Monospace">|</span> ). For example, to set the <span class="Monospace">MessageBox</span> to have a warning icon and the buttons <strong>Abort</strong>, <strong>Retry</strong>, and <strong>Ignore</strong>, you pass the following value of <span class="Monospace">uType</span> to <span class="Monospace">MessageBox</span>:</p>
<p class="code"><span class="Monospace">MB_ABORTRETRYIGNORE | MB_ICONEXCLAMATION = 0x32</span></p>
<p class="Body">In LabVIEW, you combine multiple constants by wiring integer types to the OR operator, as shown in the following block diagram.</p>
<p class="Anchor"><img src="noloc_bd_orexample.gif"></p><a name="Determining_the_Proper_Library_and_Function_Name"></a><h3>Determining the Proper Library and Function Name</h3>
<p class="Body">Before you can configure the call to the Win32 API, you must identify the DLL that contains <span class="Monospace">MessageBox</span> and the specific name of <span class="Monospace">MessageBox</span> within the DLL. Refer to the description of <span class="Monospace">MessageBox</span> in the documentation that comes with your SDK or search for <span class="Monospace">MessageBox Function ()</span> on the Microsoft Web site. The <em>Requirements</em> section of the documentation on the Microsoft Web site contains the following information:</p>
<table class="Borderless">
<tr>
<td>Minimum supported client</td>
<td>Windows 2000 Professional</td>
</tr>
<tr>
<td>Minimum supported server</td>
<td>Windows 2000 Server</td>
</tr>
<tr>
<td>Header</td>
<td>Winuser.h (include Windows.h)</td>
</tr>
<tr>
<td>Library</td>
<td>User32.lib</td>
</tr>
<tr>
<td>DLL</td>
<td>User32.dll</td>
</tr>
<tr>
<td>Unicode and ANSI names</td>
<td>MessageBoxW (Unicode) and MessageBoxA (ANSI)</td>
</tr>
</table>
<p class="Body">The DLL line specifies <span class="Monospace">user32.dll</span> as the DLL that contains <span class="Monospace">MessageBox</span>. The Unicode and ANSI names line specifies the name of the MessageBox function for each type of character encoding.</p>
</body>
</html>