<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Generated from Shared_Libraries_DLLs.xml. Edit in the XML file; do not edit this file.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Unicode Versions and ANSI Versions of Functions</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script><script src="dynamicjumps.js" type="text/javascript"></script></head>
<body>
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript><a name="Unicode_Versions_and_ANSI_Versions_of_Functions"></a><h1>Unicode Versions and ANSI Versions of Functions</h1>
<p class="Body">
				
				
				
				
				<span class="Monospace">MessageBox</span> uses two string arguments. The SDK implements two versions of functions that use string arguments, a Unicode version and an ANSI version. One of the items in the <em>Requirements</em> section of the <span class="Monospace">MessageBox</span> documentation says, �Unicode: Implemented as Unicode and ANSI version on Windows.� You can distinguish the two versions in the DLL because each has a <span class="Monospace">W</span> (Unicode) or an <span class="Monospace">A</span> (ANSI) appended to the end of the function name. <span class="Monospace">winuser.h</span> contains the following code:</p>
<p class="code"><span class="Monospace">#ifdef UNICODE</span></p>
<p class="code"><span class="Monospace">#define MessageBox MessageBoxW</span></p>
<p class="code"><span class="Monospace">#else</span></p>
<p class="code"><span class="Monospace">#define MessageBox MessageBoxA</span></p>
<p class="code"><span class="Monospace">#endif // !UNICODE</span></p>
<p class="Body">The preceding code defines <span class="Monospace">MessageBox</span> to be either <span class="Monospace">MessageBoxA</span> or <span class="Monospace">MessageBoxW</span>, depending on whether the application is a Unicode application. In effect, a <span class="Monospace">MessageBox</span> function does not exist in <span class="Monospace">user32.dll</span>. Instead, <span class="Monospace">user32.dll </span>contains a function <span class="Monospace">MessageBoxA</span> and a function <span class="Monospace">MessageBoxW</span>. In most cases in LabVIEW, you use the ANSI version of the function because the LabVIEW strings are based on ANSI, not Unicode. For this example, you use the <span class="Monospace">MessageBoxA</span> function. </p><a name="Configuring_a_Call_to_the_Win32_API"></a><h3>Configuring a Call to the Win32 API</h3>
<p class="Body">Now that you are familiar with many aspects of the Win32 API, you can configure a LabVIEW <a href="Configuring_the_CLF_Node.html">Call Library Function Node</a> to call the <span class="Monospace">MessageBox</span> function. Remember that you must use the Standard (<span class="Monospace">__stdcall</span>) calling convention in calls to any function in the Windows SDK.</p>
<p class="Body">The following front panel shows a <a href="../lvhowto/Building_Function_Prototype.html">correctly configured instance</a> of the Call Library Function Node. Make your <a href="../lvdialog/Call_Lib_Function_DB.html">Call Library Function</a> dialog box match the settings in the graphic.</p>
<p class="Anchor"><img src="loc_env_wincalldbox.gif"></p>
<p class="Body">The following block diagram shows a VI designed to call the Win32 API. Configure your block diagram to match the following block diagram.</p>
<p class="Anchor"><img src="loc_bd_wincall.gif"></p>
<p class="Body">The VI generates the following message box.</p>
<p class="Anchor"><img src="loc_fp_wincall.gif"></p>
</body>
</html>