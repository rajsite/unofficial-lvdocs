<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Generated from Windows_Connectivity.xml. Edit in the XML file; do not edit this file.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Using ActiveX with LabVIEW</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script>
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="dynamicjumps.js" type="text/javascript"></script></head>
<body>
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript><a name="Using_ActiveX_with_LabVIEW"></a><h1>Using ActiveX with LabVIEW</h1>
<p class="Body">
			
				
			To access the objects, properties, methods, and events associated with other ActiveX-enabled applications, you can use LabVIEW as an ActiveX client.  To allow other applications to access LabVIEW objects, properties, and methods, you also can use LabVIEW as an ActiveX Server. Refer to <a href="javascript:WWW(WWW_ActiveX)">ActiveX and LabVIEW</a> at <span class="Monospace">ni.com</span> for more information about using ActiveX with LabVIEW.</p><a name="ActiveX_Objects__Properties__Methods__and_Events"></a><h2>ActiveX Objects, Properties, and Methods</h2>
<p class="Body">
					
					
					
					
					ActiveX-enabled applications include objects that have exposed properties and methods that other applications can access. Objects can be visible to the users, such as buttons, windows, pictures, documents, and dialog boxes, or invisible to the user, such as application objects. You access an application by accessing an object associated with that application and setting a property or invoking a method of that object.</p><a name="ActiveX_Events"></a><h2>ActiveX Events</h2>
<p class="Body">
					
					
					
<a href="../lvconcepts/Using_ActiveX_with_LabVIEW.html#ActiveX_Events">Events</a> are the actions taken on an object, such as clicking a mouse or pressing a key. Whenever these actions occur to the object, the object sends an event to alert the ActiveX container, along with the event-specific data. The ActiveX object defines the events available for an object.</p>
<p class="Body">To use ActiveX events in an application, you must register for the event and handle the event when it occurs. ActiveX event registration is similar to <a href="../lvconcepts/Using_Events_in_LabVIEW.html#Dynamic_Event_Registration">dynamic event registration</a>. In dynamic event registration, you must place an event structure within a While Loop, wire an object reference to the event structure, and select the event you want LabVIEW to generate. For example, you can call a Windows-based tree control from an ActiveX container and specify that you want to generate a <a href="../lvprop/TreeControl_Double_Click.html">Double Click</a> event for the items displayed in the tree control. However, the architecture of an ActiveX event VI is different than the architecture of an event-handling VI because you must use the Register Event Callback function instead of the Register for Events function to specify and register events.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��National Instruments recommends that you use the <a href="../glang/Unregister_Events.html">Unregister For Events</a> function to unregister for events when you no longer need to handle them. If you do not unregister for events, LabVIEW continues to generate and queue the events as long as the VI runs, even if no <a href="../glang/Event_Structure.html">Event</a> structure is waiting to handle them, which consumes memory and can hang the VI if you enable front panel locking for the events.</td>
</tr>
</table>
<p class="Body">Refer to the following table for information about the components of generating and registering an ActiveX event in LabVIEW.</p>
<table class="Bordered">
<tr>
<th class="Bordered">Component</th>
<th class="Bordered">Description</th>
<th class="Bordered">Use Case</th>
</tr>
<tr>
<td class="Bordered"><strong>ActiveX object</strong></td>
<td class="Bordered">This is the ActiveX object for which you want to generate an event.</td>
<td class="Bordered">After you select the ActiveX object for which you want to generate an event, you can use an automation refnum to specify the event.</td>
</tr>
<tr>
<td class="Bordered"><strong>Register Event Callback function</strong></td>
<td class="Bordered">This function is a growable node capable of handling multiple events, similar to the Register For Events function.</td>
<td class="Bordered">After you wire an ActiveX object reference to the Register Event Callback function, you can specify the event(s) you want to generate for that object. When you specify the event(s) you want to generate for an object, you register the ActiveX object for that event</td>
</tr>
<tr>
<td class="Bordered"><strong>Callback VI</strong></td>
<td class="Bordered">This VI contains the code that you write to handle an event. </td>
<td class="Bordered">You can create this VI after you register for an event with the Register Event Callback function. Different events may have different event data formats. Therefore, changing the event after you create a callback VI might break wires on the block diagram.  Select the event before you create the callback VI.  </td>
</tr>
</table>
<h2>ActiveX VIs, Functions, Controls, and Indicators</h2>
<p class="Body">
					
					
					
					
					
					
					
	Refer to the following table for information about which VIs, functions, controls, and indicators to use to access the objects, properties, methods, and events associated with other ActiveX-enabled applications.</p>
<table class="Bordered">
<tr>
<th class="Bordered">VI, Function, Control, or Indicator Name</th>
<th class="Bordered">Description</th>
<th class="Bordered">Example</th>
<th class="Bordered">How to Use</th>
</tr>
<tr>
<td class="Bordered"><strong>Automation refnum control</strong></td>
<td class="Bordered">This control creates a reference to an ActiveX object.</td>
<td class="Bordered">You can create a reference to a word document embedded in an ActiveX container on the front panel of a VI.</td>
<td class="Bordered">Right-click this control on the front panel to select an object from the type library you want to access.</td>
</tr>
<tr>
<td class="Bordered"><strong>Automation Open function</strong></td>
<td class="Bordered">This function opens an ActiveX object.</td>
<td class="Bordered">You can use this function to open a Microsoft Excel document.</td>
<td class="Bordered">Right-click the function and select <strong>Select ActiveX Class</strong> to choose the class of the object from the shortcut menu. After you open the refnum, you can pass it to other <a href="../lvcomm/ActiveX_Client_Functions.html">ActiveX functions</a>.</td>
</tr>
<tr>
<td class="Bordered"><strong>ActiveX container</strong></td>
<td class="Bordered">This container accesses and displays an ActiveX object on the front panel.</td>
<td class="Bordered">You can use the ActiveX container to display a button from another ActiveX-enabled application, such as a web browser.</td>
<td class="Bordered">Right-click the container and select <strong>Insert ActiveX Object</strong> from the shortcut menu. Then select the object you want to access.</td>
</tr>
<tr>
<td class="Bordered"><strong>Property Node</strong></td>
<td class="Bordered">This function gets (reads) and sets (writes) the properties associated with an ActiveX object.</td>
<td class="Bordered">You can use this function to set the properties of an object you embed in an ActiveX container on the front panel.</td>
<td class="Bordered">Right-click an ActiveX object on the front panel or block diagram and select <strong>Create�Property Node</strong>. Then select a property from the shortcut menu to set a property for the object.</td>
</tr>
<tr>
<td class="Bordered"><strong>Invoke Node</strong></td>
<td class="Bordered">This function invokes methods associated with an ActiveX object.</td>
<td class="Bordered">Similar to how you set properties with a Property Node, you can use this function to invoke methods of an object you embed in an ActiveX container on the front panel.</td>
<td class="Bordered">Right-click an ActiveX object on the front panel or block diagram and select <strong>Create�Invoke Node</strong>. Then select a method from the shortcut menu to invoke a method for the object.</td>
</tr>
<tr>
<td class="Bordered"><strong>Register Event Callback</strong></td>
<td class="Bordered">This function handles events that occur on an ActiveX object.</td>
<td class="Bordered">You can use this function to generate and register an event, such as adding data to a Microsoft Excel spreadsheet.</td>
<td class="Bordered"></td>
</tr>
<tr>
<td class="Bordered"><strong>Variant control and indicator</strong></td>
<td class="Bordered">Together, this control and indicator pass data to or from ActiveX controls.</td>
<td class="Bordered">You can use this control and indicator to pass data to and from an ActiveX-enabled application, such as Microsoft Excel or Microsoft Word.</td>
<td class="Bordered">Navigate to the <strong>Variant &amp; Class</strong> palette to locate and drop this control and indicator on the front panel or block diagram.</td>
</tr>
</table><a name="ActiveX_Data_Types"></a><h2>Data Type Mapping</h2>
<p class="Body">
					LabVIEW converts the data types of some ActiveX properties and methods into LabVIEW data types to read and interpret the data. The following table lists the ActiveX data types and the corresponding converted LabVIEW data types.
				</p>
<table class="Bordered">
<tr>
<th class="Bordered">ActiveX Data Type</th>
<th class="Bordered">LabVIEW Data Type</th>
</tr>
<tr>
<td class="Bordered">char</td>
<td class="Bordered"><img style="display:inline" src="ci8.gif">, <img style="display:inline" src="cu8.gif"></td>
</tr>
<tr>
<td class="Bordered">short</td>
<td class="Bordered"><img style="display:inline" src="ci16.gif">, <img style="display:inline" src="cu16.gif"></td>
</tr>
<tr>
<td class="Bordered">long</td>
<td class="Bordered"><img style="display:inline" src="ci32.gif">, <img style="display:inline" src="cu32.gif"></td>
</tr>
<tr>
<td class="Bordered">hyper</td>
<td class="Bordered"><img style="display:inline" src="ci64.gif">, <img style="display:inline" src="cu64.gif"></td>
</tr>
<tr>
<td class="Bordered">float</td>
<td class="Bordered"><img style="display:inline" src="csgl.gif">, <img style="display:inline" src="cext.gif"></td>
</tr>
<tr>
<td class="Bordered">double</td>
<td class="Bordered"><img style="display:inline" src="cdbl.gif"></td>
</tr>
<tr>
<td class="Bordered">BSTR</td>
<td class="Bordered"><img style="display:inline" src="cstr.gif">, <img style="display:inline" src="cpath.gif"></td>
</tr>
</table><a name="LabVIEW_as_an_ActiveX_Client"></a><h2>LabVIEW as an ActiveX Client</h2>
<p class="Body">
					
					
When LabVIEW accesses the objects associated with another ActiveX-enabled application, LabVIEW acts as an ActiveX client. You can use LabVIEW as an ActiveX client in the following ways:</p>
<ul>
<li>Open an application, such as Microsoft Excel, create a document, and add data to that document.</li>
<li>Embed a document, such as a Microsoft Word document or an Excel spreadsheet, on the front panel in a container.</li>
<li>Place a button or other object from another application, such as a <strong>Help</strong> button that calls the other application help file, on the front panel.</li>
<li>Link to an ActiveX control you built with another application.</li>
</ul>
<p class="Body">LabVIEW accesses an ActiveX object with the automation refnum control or the ActiveX container, both of which are front panel objects. Use the automation refnum control to select an ActiveX object. Use the ActiveX container to select a displayable ActiveX object, such as a button or document, and place that object on the front panel. Both objects appear as automation refnum controls on the block diagram.</p><a name="Design_Mode_for_ActiveX_Objects"></a><h2>Design Mode for ActiveX Objects</h2>
<p class="Body">
				
				
				
				
				When you select the design mode option, the ActiveX container owns the references to controls and creates and releases new controls. Controls have distinct design and run modes. Each time you run a VI, LabVIEW removes the design mode control and replaces it with a new control in run mode. When the VI stops, LabVIEW removes the run mode control and creates a new design mode control. The relationship between design mode and run mode when you use ActiveX and LabVIEW is similar to the relationship between edit mode and run mode in other areas of LabVIEW programming, such as VI Scripting or VI Server.</p>
<p class="Body">Built applications do not include design mode control. LabVIEW creates the run mode control when the VI starts and releases the control when the VI stops. LabVIEW generates events only in run mode, not in design mode. The default mode is run mode.</p>
<p class="Body">Refer to the following illustration for information about how to configure design mode.</p>
<p class="Anchor"><img src="loc_fp_design_mode.gif"></p><a name="Setting_ActiveX_Properties"></a><h3>Methods for Setting ActiveX Properties</h3>
<p class="Body">
					
					
					After you open an ActiveX server or insert an ActiveX control or document, you can set the properties associated with that control or document using the ActiveX Control Property Browser, property pages, and the Property Node.</p>
<table class="Bordered">
<tr>
<th class="Bordered">Name</th>
<th class="Bordered">Description</th>
<th class="Bordered">How To Access</th>
</tr>
<tr>
<td class="Bordered"><strong>ActiveX Control Property Browser</strong></td>
<td class="Bordered"> Use this browser to view and set all the properties associated with an ActiveX control or document in an ActiveX container. The ActiveX Control Property Browser is an easy way to set the properties of an ActiveX object interactively.
				<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��You can use the browser only to set properties while in edit mode and only with ActiveX objects in a container.
</td>
</tr>
</table>
</td>
<td class="Bordered">Access the ActiveX Control Property Browser in either of the following ways: 
<ol>
<li>Right-click the control or document in the container on the front panel and select <strong>Property Browser</strong> from the shortcut menu.</li>
<li><strong>Select View�ActiveX Control Property Browser</strong>.</li>
</ol>
</td>
</tr>
<tr>
<td class="Bordered"><strong>ActiveX Property Pages</strong></td>
<td class="Bordered">Many ActiveX objects include property pages, which organize the properties associated with the object on separate tabs. <br><br>Like the ActiveX Control Property Browser, ActiveX property pages are an easy way to set the properties of an ActiveX object interactively. Also like the ActiveX Control Property Browser, you can use property pages only to set properties while in edit mode and with ActiveX objects in a container.<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��Not all ActiveX objects provide property pages.</td>
</tr>
</table>
</td>
<td class="Bordered">To access ActiveX property pages, right-click the object in the container on the front panel and select the name of the object from the shortcut menu.</td>
</tr>
<tr>
<td class="Bordered"><strong>Property Nodes</strong></td>
<td class="Bordered">Use the Property Node to set ActiveX properties programmatically.</td>
<td class="Bordered">Complete the following steps to use a Property Node to set ActiveX properties programmatically:
					<ol>
<li>Obtain a reference to the ActiveX object for which you want to create an ActiveX property.</li>
<li>Add a Property Node to the block diagram</li>
<li>Wire the reference to the object to the reference input of the node.</li>
</ol>
</td>
</tr>
</table>
<p class="Body">The following block diagram example demonstrates how to use a Property Node to programmatically change the Value property of an ActiveX control to warn a user when a temperature exceeds a certain limit. The Value property of the CWButton ActiveX control, which is part of the National Instruments Measurement Studio User Interface ActiveX Library, is changed when the temperature reaches 85 degrees Fahrenheit or higher.</p>
<p class="Body">In this example, the CWButton control acts as an LED, changes colors, and displays <span class="Monospace">Warning</span> when the temperature reaches the limit, which is the �on� state of the CWButton control.</p>
<p class="Anchor"><img src="loc_bd_monitortemp.gif"></p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��Instead of setting the OffText, OffColor, OnText, and OnColor properties for the CWButton control properties programmatically, you can use the ActiveX Control Property Browser or property pages to set properties for those controls.</td>
</tr>
</table><a name="LabVIEW_as_an_ActiveX_Server"></a><h2>LabVIEW as an ActiveX Server</h2>
<p class="Body">
					
					
You can access a LabVIEW application, VIs, and properties and methods for controls through ActiveX calls from other applications. Other ActiveX-enabled applications, such as Microsoft Excel, can request properties, methods, and individual VIs from LabVIEW. LabVIEW acts as an ActiveX server.</p>
<p class="Body">For example, you can embed a VI graph in an Excel spreadsheet and, from the spreadsheet, enter data in the VI inputs and run the VI. When you run the VI, the data plot to the graph.</p><a name="Support_for_Custom_ActiveX_Automation_Interfaces"></a><h3>Support for Custom ActiveX Automation Interfaces</h3>
<p class="Body">
					
					
					If you write to a third party ActiveX client that uses LabVIEW to access properties and methods from a LabVIEW ActiveX server, you can access custom interfaces exposed by the server. You can do this without IDispatch.</p>
<p class="Body">However, the developer of the ActiveX server must make sure the parameters of the properties and methods in these custom interfaces have Automation (IDispatch) data types. The developer of the server must ensure the parameters have Automation (IDispatch) data type in order to expose multiple interfaces from one object, rather than through multiple objects. Without Automation data types, you must make a connection for each object to which you connect, rather than just one connection. You still can use the interfaces in the LabVIEW environment.</p><a name="Using_Constants_to_Set_Parameters_in_ActiveX_VIs"></a><h2>Using Constants to Set Parameters in ActiveX VIs</h2>
<p class="Body">
				
				
				
Some parameters in ActiveX nodes accept a discrete list of valid values. Select the descriptive name in the ring constant to set these parameter values.</p>
<p class="Body">To access the ring constant when building an ActiveX VI, right-click the parameter of the node that accepts data values and create a constant. The selections available in the ring constant depend on the refnum passed to the node. To view the corresponding numeric data value, right-click the ring constant and select <strong>Visible Items�Digital Display</strong> from the shortcut menu.</p>
<p class="Body">The following block diagrams illustrate how to use ring and numeric constants to set parameter values. The block diagrams access the Microsoft Excel Application and execute a method, and the <strong>Index</strong> parameter includes several options.  When you select an option, LabVIEW displays the corresponding numeric value of the option.</p>
<p class="Body">By default, as displayed in the following block diagram, LabVIEW displays the numeric value of the currently selected option, <strong>MicrosoftAccess</strong>, in a box next to the ring constant. </p>
<p class="Anchor"><img src="loc_bd_sparse2.gif"></p>
<p class="Body">However, you also can choose to display the numeric value of an option in a numeric constant. As displayed in the following block diagram, LabVIEW displays the numeric value of an option in a numeric constant wired to the <strong>Index</strong> input.</p>
<p class="Anchor"><img src="loc_bd_sparse1.gif"></p><a name="Loading_VIs_with_an_Updated_ActiveX_Type_Library"></a><h2>Loading VIs with an Updated ActiveX Type Library</h2>
<p class="Body">When you load a VI with a change in the major version of an ActiveX Type Library, LabVIEW launches a warning dialog box to inform you of the change. When you load a VI with a change in the minor version or time stamp of an ActiveX Type Library, the VI, once loaded, includes an asterisk in its title bar and in the list of open VIs displayed in the <strong>Window</strong> menu. When you save the VI, the asterisk disappears until you make a new change. </p>
</body>
</html>