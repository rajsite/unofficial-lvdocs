<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Generated from Loops_and_Structures.xml. Edit in the XML file; do not edit this file.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Configuring Settings of a Timed Structure (Real-Time, Windows)</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script>
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="dynamicjumps.js" type="text/javascript"></script></head>
<body>
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript><a name="Configuring_Advanced_Settings_of_a_Timed_Structure"></a><h1>Configuring Settings of a Timed Structure (Real-Time, Windows)</h1>
<p class="Body">
				
				
				You can use the configuration dialog boxes of timed structures to configure advanced settings such as deadlines, timeouts, and secondary timing sources for timed structures. Double-click the Input node or right-click the Input node and select <strong>Configure Input Node</strong> from the shortcut menu to display the <a href="../lvdialog/Loop_Configuration_DB.html">Configure Timed Loop</a>, <a href="../lvdialog/Sequence_Configuration_DB.html">Configure Timed Sequence</a>, or <a href="../lvdialog/Loop_Configuration_Frames_DB.html">Configure Timed Loop with Frames</a> dialog box.</p><a name="Setting_a_Deadline"></a><h2>Setting a Deadline</h2>
<p class="Body">A deadline allots a specific amount of time for a subdiagram, or frame, to complete execution, relative to the start of the frame. Use a deadline to set a time limit reference for the execution of a subdiagram. If a frame does not complete before the deadline, the Left Data node of the next frame returns <span class="Monospace">TRUE</span> in the <strong>Finished Late?</strong> output and continues to execute. Specify a deadline value in the same units as the frame timing source.</p>
<p class="Body">In the following example, the first frame of the Timed Sequence structure is configured with a deadline of 50. The deadline specifies that the frame must complete execution before 50 ticks of the 1 kHz clock, or 50 ms. However, since there is a VI in the frame calling for a 60 ms wait, the code in the frame takes 60 ms to complete. The <strong>Finished Late?</strong> output of the second frame will return <span class="Monospace">TRUE</span> because the frame execution does not meet the specified deadline.</p>
<p class="Anchor"><img src="loc_bd_setting_ts_deadline.gif"></p><a name="Setting_a_Timeout"></a><h2>Setting a Timeout</h2>
<p class="Body">A timeout specifies the maximum amount of time, in milliseconds, a frame can wait to begin execution. The timeout value is relative to the start of the iteration or relative to the end of the previous frame. If the execution of the subdiagram does not begin before the specified timeout value, the Timed Loop returns <span class="Monospace">Timeout</span> in the <strong>Wakeup Reason</strong> output of the Left Data node for that frame.</p>
<p class="Body">You can use <a href="../lvconcepts/CON_Select_Timed_Struct_Timing.html">several types of NI-DAQmx timing sources</a>, including digital edge counters and signals from task sources, to control timed structures and to specify a timeout. In the following example, the second frame of the Timed Sequence structure executes when the <a href="../lvdaqmx/mxcreatetimingsource.html" class="checkLink lvdaqmx">DAQmx Create Timing Source</a> VI receives a pulse from an external device. The external device sends a pulse every 50 ms under ideal conditions, but the pulse timing can vary. The timeout value of 60 ms for the second frame indicates that the frame can wait 60 ms to start after the beginning of the iteration. If the second frame does not start before 60 ms, the structure continues to execute the rest of the iteration untimed and the second frame returns <span class="Monospace">Timeout</span> in the <strong>Wakeup Reason</strong> output of the Left Data node.</p>
<p class="Anchor"><img src="loc_bd_setting_ts_timeout.gif"></p>
<p class="Body">If a timeout occurs in a timed structure, the structure continues to execute the rest of the iteration untimed. The timed structure returns <span class="Monospace">Timeout</span> in the <strong>Wakeup Reason</strong> output of the remaining frames. The timing information provided by the remaining frames equals the timing information for the frame where the timeout occurred. If a Timed Loop must complete another iteration, the loop stops at the same frame where the timeout occurred and waits for the original timeout event.</p>
<p class="Body">The default timeout value for the first frame of a timed structure is <span class="Monospace">-1</span>, which indicates to wait indefinitely for the start of the subdiagram, or frame. The default timeout value for other frames is <span class="Monospace">0</span>, which indicates no change from the timeout value of the previous frame.</p><a name="Setting_an_Offset"></a><h2>Setting an Offset</h2>
<p class="Body">An offset is the length of time, relative to the start of the timed structure, a structure waits to begin execution of the first subdiagram, or frame. The offset is defined in absolute units of the structure timing source.</p>
<p class="Body">You can align the phase of different timed structures using an offset and setting the same timing source for both structures. The Timed Loops in the following block diagram use the same 1 kHz timing source and have offset (<strong>t0</strong>) values of 500, meaning the Loops wait 500 ms after the timing source trigger to begin executing their iterations.</p>
<p class="Anchor"><img src="loc_bd_timed_structures_offset.gif"></p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��Aligning the phase of two timed structures does not guarantee that the structures start at the same time. Use the <a href="../glang/Synchronize_Timed_Loop_Starts.html">Synchronize Timed Structure Starts</a> VI to <a href="Sync_Timed_Structs.html">synchronize the start of timed structures</a> on the block diagram.</td>
</tr>
</table>
<p class="Body">In the last frame of a Timed Loop, you can use the Right Data node to <a href="../lvconcepts/CON_Change_TSNodes_Dynam.html">change the offset for subsequent iterations of the loop dynamically</a>. However, when you change the offset for subsequent iterations dynamically, you also must specify a mode by wiring a value to the <strong>Mode</strong> input of the Right Data node.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��You cannot wire <strong>No Change</strong> to the <strong>Mode</strong> input if you change the offset using the right data node. You must select a mode value.</td>
</tr>
</table>
<p class="Body">Refer to the Timed Loop Offset VI in <span class="Monospace">labview\examples\Structures\Timed Loop</span> directory for an example of setting the offset for a Timed Loop.</p>
<p class="Body">
				<a href="javascript:openVI('examples%5C%5CStructures%5C%5CTimed%20Loop%5C%5CTimed%20Loop%20Offset.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a> Open example�
		
				<a href="javascript:findExamples(3154);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a> Find related examples
			</p><a name="Assigning_a_Processor"></a><h2>Assigning a Processor</h2>
<p class="Body">
				By default, LabVIEW automatically assigns available processors to handle the execution of timed structures. However, you manually can load balance timed structures across multiple processors for further execution control.</p>
<p class="Body">Select <strong>Manual</strong> from the <strong>Mode</strong> pull-down menu in the <strong>Processor Assignment</strong> section of the <a href="../lvdialog/Loop_Configuration_DB.html">Configure Timed Loop</a>, <a href="../lvdialog/Loop_Configuration_Frames_DB.html">Configure Timed Loop with Frames</a>, <a href="../lvdialog/Sequence_Configuration_DB.html">Configure Timed Sequence</a>, <a href="../lvdialog/Config_Next_Frame_Timing_DB.html">Configure Next Frame Timing</a>, or <a href="../lvdialog/Loop_Config_Next_Iteration_DB.html">Configure Next Iteration</a> dialog box to manually configure a processor to handle a timed structure. You also must enter an integer between <span class="Monospace">0</span> and <span class="Monospace">255</span>, where <span class="Monospace">0</span> represents the first available processor in the system, in the <strong>Processor</strong> field to specify which processor you want to handle the execution. If you attempt to enter a number out of the specified range, LabVIEW coerces it between <span class="Monospace">0</span> and <span class="Monospace">255</span>. If you enter a number that exceeds the number of available processors, you generate a run-time error and the timed structure does not execute.</p>
<p class="Body">If you select <strong>Automatic</strong> from the <strong>Mode</strong> pull-down menu, LabVIEW automatically assigns a processor to the structure and the <strong>Processor</strong> value automatically sets to <span class="Monospace">-2</span>. If you select <strong>No Change</strong> from the <strong>Mode</strong> pull-down menu for a frame or subsequent iteration, LabVIEW uses the same processor that handled the previous frame or iteration and the <strong>Processor</strong> value automatically sets to <span class="Monospace">-1</span>.</p>
<p class="Body">You also can wire a value to the <strong>Processor</strong> input of the Input node of a timed structure or timed structure frame to set the processor assignment.</p>
<p class="checkFile lvrthelp Body">Refer to <a href="../lvrtconcepts/RT_SMP.html">Optimizing RT Applications for Multiple-CPU Systems</a> for more information about optimizing timed structure performance by manually assigning processors.</p><a name="Setting_a_Secondary_Timing_Source"></a><h2>Setting a Secondary Timing Source</h2>
<p class="Body">You can use a second timing source to control the subdiagrams, or frames, of a timed structure with a different clock source than the structure itself. Use the <strong>Frame Timing Source</strong> section of the <a href="../lvdialog/Loop_Configuration_DB.html">Configure Timed Loop</a>, <a href="../lvdialog/Loop_Configuration_Frames_DB.html">Configure Timed Loop with Frames</a>, or <a href="../lvdialog/Sequence_Configuration_DB.html">Configure Timed Sequence</a> dialog boxes to select a secondary timing source.</p>
<p class="Body">The timed structures support the following secondary timing sources:</p>
<ul>
<li>
					<strong>Use timing source of loop</strong> or <strong>sequence</strong>�Use the same timing source of the timed structure to time the frames.</li>
<li>
					<strong>Use built-in source from below</strong>�Use a separate built-in timing source to time the frames.
					<ul class="List-Hyphen">
<li>
							<strong>1 kHz Clock &lt;reset at structure start&gt;</strong>�A timing source similar to the 1 kHz clock that resets to 0 after every iteration of a timed structure.</li>
<li>
							<strong>1 MHz Clock &lt;reset at structure start&gt;</strong>�A timing source similar to the 1 MHz clock that resets to 0 after every iteration of a timed structure.</li>
</ul>
				</li>
</ul><a name="Absolute_and_Relative_Time_in_Timed_Structures"></a><h2>Absolute and Relative Time in Timed Structures</h2>
<p class="Body">
			A designated <a href="../lvconcepts/CON_Select_Timed_Struct_Timing.html">timing source</a> governs timed structure execution. However, not all timed structure configuration options refer to the absolute value of the timing source. In Timed Loops with frames and Timed Sequence structures with frames, some configuration options are relative to the timing of the previous frame or the current frame. Options that refer to the start or finish of a frame execution use relative time, while options that refer to the timing source use absolute time.
			</p>
<p class="Body">In timed structures, the offset is governed by absolute time, and outputs like <strong>Expected Start</strong>, <strong>Expected End</strong>, <strong>Actual Start</strong>, and <strong>Actual End</strong> are calculated in units of absolute time for frame and iteration timing. The start time, deadline, and timeout for each frame are governed by relative time. The start time and timeout are relative to the beginning of the previous frame execution, the deadline is relative to the beginning of the current frame. 
			</p>
<p class="Body">In the following block diagram, a Timed Loop with frames governed by a 1 kHz clock has a period of 1000 ms and an offset of 100 ms. The offset is governed by absolute time, so the loop iterates when the timing source clock reaches 100 ms, 1100 ms, 2100 ms, 3100 ms, and so on, until the loop execution completes. 
			</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��A Timed Loop that is late can use absolute or relative time, depending on the <a href="Configuring_the_LabVIEW_Timed_Loop.html#Timed_Loop_Modes">mode of the Timed Loop</a>.</td>
</tr>
</table>
<p class="Anchor"><img src="loc_eps_timeline.gif"></p>
<table class="Bordered">
<tr>
<td class="Bordered">1</td>
<td class="Bordered">Offset</td>
<td class="Bordered">Absolute time�refers to loop timing source</td>
</tr>
<tr>
<td class="Bordered">2</td>
<td class="Bordered">Deadline</td>
<td class="Bordered">Relative time�refers to start of second frame</td>
</tr>
<tr>
<td class="Bordered">3</td>
<td class="Bordered">Start</td>
<td class="Bordered">Relative time�refers to start of first frame</td>
</tr>
<tr>
<td class="Bordered">4</td>
<td class="Bordered">Timeout</td>
<td class="Bordered">Relative time�refers to start of end frame</td>
</tr>
</table>
<p class="Body">The second frame of the Timed Loop has a start time of 75 ms. Since the start time is relative to the beginning of the execution of the previous frame, the frame execution can start no earlier than 75 ms after the first frame begins to execute. According to absolute time maintained by the timing source, the start time for the second frame is 175 ms in the first iteration, since the second frame executes no earlier than 75 ms after the first frame begins at 100 ms on the timing source clock.</p>
<p class="Body">The frame also has a timeout input of 2000 ms. The timeout establishes a maximum wait for the start of one frame after the beginning of the execution of the previous frame. If the second frame does not begin to execute within 2000 ms of the beginning of the execution of the first frame, LabVIEW executes the rest of the iteration untimed and returns <span class="Monospace">Timeout</span> in the <strong>Wakeup Reason</strong> output on the Left Data node. If the second frame does begin to execute before the 2000 ms for the timeout passes, the deadline of 150 ms then places a limit on the amount of time the frame can spend executing. From the point in time when the second frame begins to execute, 150 ms can pass before the frame will output a TRUE value in the <strong>Finished Late</strong> indicator. 
			</p>
</body>
</html>