<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- Generated from Shared_Variables.xml. Edit in the XML file; do not edit this file.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Reading and Writing Shared Variables Programmatically</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script>
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="dynamicjumps.js" type="text/javascript"></script></head>
<body>
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript><h1>Reading and Writing Shared Variables Programmatically</h1>
<p class="Body">
			
		If you have an application that accesses a large number of shared variables, you can read and write those shared variables programmatically with the  <a href="../lvcomm/Shared_Variable_Reference.html">Shared Variable</a> functions. This programming technique often is cleaner and more scalable than <a href="../lvconcepts/SV_Using_Nodes.html">using Shared Variable nodes</a> because you can access multiple shared variables with a single Shared Variable function, whereas each <a href="../lvcomm/variable_node.html">Shared Variable</a> node accesses a single shared variable only.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��You can access the following types of shared variables programmatically:
				
				<ul>
<li><strong>PSP Variables</strong>�Data items published on the network using the <a href="../lvconcepts/NI_PSP.html">NI Publish-Subscribe Protocol (NI-PSP)</a>. Common examples of PSP variables include network-published shared variables, I/O variables with network-publishing enabled, and DAQ channels published through the NI-DAQmx I/O server.</li>
<li><a href="../lvioscanhelp/io_vars.html"><strong>I/O Variables</strong></a>�Shared variables that use the <a href="../lvioscanhelp/scan_engine.html">NI Scan Engine</a> for single-point access to I/O data.</li>
</ul>
		</td>
</tr>
</table>
<p class="Body">The following figure shows an example of reading shared variables programmatically, placing those values in a preallocated array, and processing those values.</p>
<p class="Anchor"><img src="loc_bd_ProgAccess.gif"></p>
<p class="Body">The following events occur in the previous figure.</p>
<ol>
<li>The <a href="../lvcomm/Search_Var_Objects.html">Search Variable Container</a> function finds all of the shared variables of the double data type under <span class="Monospace">My Library</span>, and the <strong>refnum array out</strong> output returns an array of references to those shared variables.</li>
<li>The <a href="../lvcomm/SV_Dynamic_Open.html">Open Variable Connection</a> function uses the array of variable identifier URLs to open a connection to each shared variable. The For Loop stops if an error occurs.</li>
<li>The <a href="../glang/Array_Size.html">Array Size</a> function uses the array of shared variable references to calculate the number of shared variables that the Search Variable Container function found.</li>
<li>The <a href="../glang/Initialize_Array.html">Initialize Array</a> function uses the number of shared variables to create an array for the shared variable data. By initializing an array for the shared variable data outside of the <a href="../glang/While_Loop.html">While Loop</a>, this application optimizes CPU usage.</li>
<li>The <a href="../lvcomm/SV_Dynamic_Read.html">Read Variable</a> function reads each of the shared variables that the Open Variable Connection function opened.</li>
<li>The <a href="../glang/Replace_Array_Subset.html">Replace Array Subset</a> function stores the shared variable data in the array that the Initialize Array function created.</li>
<li>The Process Data subVI processes the array of shared variable data.</li>
<li>The read and process operations run continuously in the While Loop until an error occurs or the user clicks the <strong>Stop</strong> button.</li>
<li>The <a href="../lvcomm/SV_Dynamic_Close.html">Close Variable Connection</a> function closes the shared variable connections.</li>
</ol>
<p class="Body">This application achieves the same functionality as one that uses Shared Variable nodes. However, because this application uses programmatic shared variable access, you can scale to hundreds or thousands of variables without updating the block diagram. For example, assume that <strong>My Library</strong> contains ten variables, Variable1 through Variable10. You could use the <a href="../lvdialog/DSC_Batch_Var_Creation.html">Batch Variable Creation</a> dialog box to add Variable11 through Variable500 to <strong>My Library</strong>. After you redeploy <strong>My Library</strong>, the next time you run the VI, it reads Variable1 through Variable500 with no need to add Variable11 through Variable500 to the block diagram.</p>
<p class="Body">The following sections provide information about the programming techniques in the above example.</p><a name="FindVars"></a><h2>Finding Shared Variables</h2>
<p class="Body">Use the <a href="../lvcomm/Search_Var_Objects.html">Search Variable Container</a> function to search for shared variables and variable containers that meet specific criteria. For example, the VI shown in the following block diagram uses this function to find all the shared variables under a given container that meet the following criteria:</p>
<ul>
<li>Exists in My Library on the local computer</li>
<li>Double data type</li>
<li><a href="../lvconcepts/SV_URLs.html">Variable identifier URL</a> contains the string <span class="Monospace">foo</span></li>
</ul>
<p class="Anchor"><img src="loc_bd_Search_Vars.gif"></p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��You can use the <a href="../lvdialog/Browse_Variables.html">Browse Variable Object</a> dialog box to browse for shared variables and variable containers at edit-time either on the network or in the current project. Click the drop-down arrow on a Variable control or constant, such as the <strong>container refnum in</strong> constant in the figure above, and select <strong>Browse</strong> to display the <strong>Browse Variable Object</strong> dialog box.</td>
</tr>
</table>
<table class="Borderless">
<tr>
<td class="Icon"><img src="caution.gif"></td>
<td class="Dark-Red"><strong>Caution</strong>��When reading and writing shared variables that you find programmatically, you might read or write data of the wrong data type. Use the <strong>data type</strong> input of the Search Variable Container function to avoid reading or writing a shared variable of the wrong data type.</td>
</tr>
</table>
<p class="Body">You also can use the following Variable Container <a href="../lvprop/Dynamic_VarContainer_p.html">properties</a> and <a href="../lvprop/Dynamic_VarContainer_FindDescendants.html">method</a> to find shared variables programmatically.</p>
<ul>
<li><a href="../lvprop/Dynamic_VarContainer_Descendants.html">All Variables property</a></li>
<li><a href="../lvprop/Dynamic_VarContainer_Children.html">Children property</a></li>
<li><a href="../lvprop/Dynamic_VarContainer_FindDescendants.html">Find Descendants method</a></li>
</ul>
<p class="Body">The VI in the following figure uses the <a href="../lvprop/Dynamic_VarContainer_Descendants.html">All Variables</a> property to find all the PSP variables hosted on the local network.</p>
<p class="Anchor"><img src="loc_bd_FindVarsProg.gif"></p>
<p class="Body">The following events occur in the previous figure.</p>
<ol>
<li>The <a href="../lvcomm/Local_Var_Eng_Ref.html">Local Variable Object Reference</a> constant passes a reference to the local PSP Variable Engine to the <a href="../lvprop/Dynamic_PSPEngine_RemoteEngines.html">Remote Engines</a> property.</li>
<li>The Remote Engines property returns the <strong>array of PSP Variable Engines</strong> hosted on other computers on the network. The VI then iterates over each PSP Variable Engine in a <a href="../glang/For_Loop.html">For Loop</a>.</li>
<li>The <a href="../lvprop/Dynamic_VarEngine_Root.html">Root</a> property obtains a reference to the root PSP Variable Container on each remote computer.</li>
<li>The <a href="../lvprop/Dynamic_VarContainer_Descendants.html">All Variables</a> property obtains an array of references to all the variables hosted on each remote computer.</li>
<li>The VI adds all the variables found on the network to the <strong>All PSP Variables</strong> array.</li>
</ol>
<table class="Borderless">
<tr>
<td class="Icon"><img src="tip.gif"></td>
<td><strong>Tip</strong>��You can use the <a href="../lvcomm/Variable_PropNode.html">Variable Property Node</a>, which is preconfigured with the Variable Object class, as a starting point for building the block diagram in the previous figure.</td>
</tr>
</table><a name="OpenClose"></a><h2>Opening and Closing Shared Variable Connections</h2>
<p class="Body">Use the <a href="../lvcomm/SV_Dynamic_Open.html">Open Variable Connection</a> function to open a connection to a variable programmatically, as shown in the following block diagram.</p>
<p class="Anchor"><img src="loc_bd_OpenVarCons.gif"></p>
<p class="Body">After the application finishes accessing the shared variables, use the <a href="../lvcomm/SV_Dynamic_Close.html">Close Variable Connection</a> function in a For Loop to close all the variable references. This function frees the memory resources allocated to each variable connection.</p><a name="ReadWrite"></a><h2>Reading and Writing Shared Variables</h2>
<p class="Body">Use the <a href="../lvcomm/SV_Dynamic_Read.html">Read Variable</a> function to read live variable values programmatically. Unlike the <a href="../lvcomm/variable_node.html">Shared Variable</a> node, which you must bind to a specific shared variable at edit time, the Read Variable function includes a <strong>shared variable refnum in</strong> input that you use to specify the shared variable to read at run time. For example, you can use the Read Variable function inside a For Loop to read multiple shared variables specified by an array of refnums, as shown in the following block diagram.</p>
<p class="Anchor"><img src="loc_bd_ReadVars.gif"></p>
<p class="Body">Use the <a href="../lvcomm/SV_Dynamic_Write.html">Write Variable</a> function to write live variable values programmatically. For example, you can use the Write Variable function inside a For Loop to write to multiple shared variables specified by an array of refnums.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="tip.gif"></td>
<td><strong>Tip</strong>��You can optimize performance and streamline the block diagram by <a href="../lvioscanhelp/BlockIOAccess.html#RW_IOV_Container">reading and writing I/O variable containers</a> as arrays.</td>
</tr>
</table>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td><strong>Note</strong>��<!-- start_parent   = ..//SV_Using_Nodes.html-->If you write less than 8 kilobytes of data to a shared variable, LabVIEW can take up to 10 milliseconds to send that data over the network. To eliminate this delay, use the <a href="../lvcomm/flushsharedvar.html">Flush Shared Variable Data</a> VI to <a href="../lvconcepts/SV_Flush.html">send the shared variable data immediately</a>.<!-- end_parent  = ..//SV_Using_Nodes.html--></td>
</tr>
</table>
<p class="Body"><img style="display:inline" src="back_arrow.gif"> <a href="../lvconcepts/Data_Comm.html"><em>Data Communication Methods</em> Home</a></p>
</body>
</html>