<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><!--Generated from database. Edit in the database; do not edit this file.--><!--VI id="249"--><HTML><head><!--LabVIEW VI path:vi.lib\Analysis\8numeric.llb\Peak Detector.vi--><TITLE>Peak Detector VI</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="STYLESHEET" type="text/css" href="minimal.css"><script src="common.js" type="text/javascript"></script><script src="jquery-1.7.2.min.js" type="text/javascript"></script><script src="cssframes.js" type="text/javascript"></script><link media="print" rel="stylesheet" type="text/css" href="print.css"></head><body bgcolor="#ffffff"><noscript><p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p><hr width="100%" noshade></noscript><div id="styleDivTitle"><!-- VI or Function Name --><H1>Peak Detector VI</H1><!--Owning Palette--><p class="Body"><strong>Owning Palette:</strong> <a href="../lvanls/Signal_Operation_VIs.html">Signal Operation VIs</a></p><!--Package and Platform--><p class="Body"><strong>Requires:</strong> Full Development System</p><!-- VI/Function Description --><p class="Body">Finds the location, amplitude, and second derivative of peaks or valleys in the input signal.</p><!-- Supplemental VI/Function Information --><!-- Link to Additional VI/Function Information --><p class="Body"><a href="#details">Details</a>&nbsp;&nbsp;<a href="#examples">Example</a></p><!-- Graphic Reference --><MAP NAME="connector_pane"><AREA SHAPE="rect" COORDS="0,28,88,36" HREF="#Input0"><AREA SHAPE="rect" COORDS="0,41,88,50" HREF="#Input1"><AREA SHAPE="rect" COORDS="0,55,88,64" HREF="#Input2"><AREA SHAPE="rect" COORDS="0,69,88,80" HREF="#Input3"><AREA SHAPE="rect" COORDS="0,83,88,94" HREF="#Input4"><AREA SHAPE="rect" COORDS="0,97,88,108" HREF="#Input5"><AREA SHAPE="rect" COORDS="205,12,246,21" HREF="#Output0"><AREA SHAPE="rect" COORDS="205,28,252,36" HREF="#Output1"><AREA SHAPE="rect" COORDS="205,41,259,52" HREF="#Output2"><AREA SHAPE="rect" COORDS="205,55,282,64" HREF="#Output3"><AREA SHAPE="rect" COORDS="205,72,231,78" HREF="#Output4"></MAP><p class="Anchor"><img src="peakdet.gif" usemap="#connector_pane" border="0"></p><!--Add/Find Buttons--><table class="Borderless"><tr><td><a href="javascript:placeObject(object249);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add to the block diagram</td><td><a href="javascript:findObject(object249);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find on the palette</td></tr></table></div><div id="styleDivScrolling"><!-- Table of VI/Function Parameters --><table class="Borderless"><tr><td class="Icon"><a name="Input0"></a><img src="c1ddbl.gif"></td><td><strong>X</strong> is the array of input values that represents the signal to be analyzed. The data can be a single array or consecutive blocks of data. Consecutive blocks of data are useful for large data arrays or for real time processing. Notice that in real time processing, <strong>peaks/valleys</strong> are not detected until approximately <strong>width</strong>/2 data points past the peak or valley.</td></tr><tr><td class="Icon"><a name="Input1"></a><img src="cdbl.gif"></td><td><strong>threshold</strong> instructs the VI to ignore peaks and valleys that are too small. The VI ignores peaks if the fitted amplitude is less than <strong>threshold</strong>. The VI ignores valleys if the fitted trough is greater than <strong>threshold</strong>. </td></tr><tr><td class="Icon"><a name="Input2"></a><img src="ci32.gif"></td><td><strong>width</strong> specifies the number of consecutive data points to use in the quadratic least squares fit. <strong>width</strong> is coerced to a value greater than or equal to 3. The value should be no more than about 1/2 of the width of the peaks above <strong>threshold</strong> or valleys below <strong>threshold</strong> and can be much smaller (but &gt; 2) for noise-free data. Large widths can reduce the apparent amplitude of peaks and shift the apparent location. For noisy data, this modification is unimportant since the noise obscures the actual peak. Ideally, <strong>width</strong> should be as small as possible but must be balanced against the possibility of false peak detection due to noise.</td></tr><tr><td class="Icon"><a name="Input3"></a><img src="cenum.gif"></td><td><strong>peaks/valleys</strong> specifies whether the VI looks for peaks or valleys in the input signal. <br><br><table class="Bordered"><tr><td class = "Bordered">0</td><td class = "Bordered">Peaks</td></tr><tr><td class = "Bordered">1</td><td class = "Bordered">Valleys</td></tr></table></td></tr><tr><td class="Icon"><a name="Input4"></a><img src="cbool.gif"></td><td><strong>initialize</strong>, when set to TRUE, specifies processing the first block of data. The VI requires some internal setup at the beginning for proper operation. If you only want to process one block of data, leave <strong>initialize</strong> unwired, or set its default state to TRUE. If you want to process consecutive blocks of data, set <strong>initialize</strong> to TRUE for the first block and FALSE for all other blocks of data.</td></tr><tr><td class="Icon"><a name="Input5"></a><img src="cbool.gif"></td><td><strong>end of data</strong>, when set to TRUE, specifies processing the last block of data. After processing the last block of data, the VI manages internal data. If you only want to process one block of data, leave <strong>end of data</strong> unwired, or set its default state to TRUE. If you want to process consecutive blocks of data, set <strong>end of data</strong> to FALSE for all but the last block of data.</td></tr><tr><td class="Icon"><a name="Output0"></a><img src="ii32.gif"></td><td><strong># found</strong> is the number of <strong>peaks/valleys</strong> found in the current block of data. <strong># found</strong> is the size of the arrays <strong>Locations</strong>, <strong>Amplitudes</strong>, and <strong>2nd Derivatives</strong>. </td></tr><tr><td class="Icon"><a name="Output1"></a><img src="i1ddbl.gif"></td><td><strong>Locations</strong> contains the index locations of all peaks or valleys detected in the current block of data. Because the peak detection algorithm uses a quadratic fit to find the peaks, it actually interpolates between the data points. Therefore, the indexes are not integers. In other words, the peaks found are not necessarily actual points in the input data but may be at fractions of an index and at amplitudes not found in the input array.<br><br>To view the locations in terms of time, use the following equation.<p class="Indent1">Time Locations[<em>i</em>] = <em>t0</em> + <em>dt</em>*Locations[<em>i</em>]</p></td></tr><tr><td class="Icon"><a name="Output2"></a><img src="i1ddbl.gif"></td><td><strong>Amplitudes</strong> contains the amplitudes of peaks or valleys found in the current block of data. <table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;The <strong>Locations</strong> and <strong>Amplitudes</strong> might deviate from actual peaks or valleys for noisy signals with large dynamic ranges.</td></tr></table></td></tr><tr><td class="Icon"><a name="Output3"></a><img src="i1ddbl.gif"></td><td><strong>2nd Derivatives</strong> gives measurements of the second derivative of the amplitude at each of the peaks or valleys found in the current block of data. <strong>2nd Derivatives</strong> gives an approximate measure of the sharpness of each peak or valley. If you are detecting peaks, these values are all negative. If you are detecting valleys, the values are all positive.<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;It is assumed that <em>dt</em>, the time difference between samples, is equal to 1.</td></tr></table></td></tr><tr><td class="Icon"><a name="Output4"></a><img src="ii32.gif"></td><td><strong>error</strong> returns any <a href="../lverror/Error_Code_Ranges.html">error</a> or warning from the VI. You can wire <strong>error</strong> to the <a href="../glang/Err_Cluster_from_Code.html">Error Cluster From Error Code</a> VI to convert the error code or warning into an error cluster. </td></tr></table><!-- Additional VI/Function Information --><h2><a name="details">Peak Detector Details</a></h2><p class="Body">The data set can be passed to the Peak Detector VI as a single array or as consecutive blocks of data.</p><p class="Body">This Peak Detector VI is based on an algorithm that fits a quadratic polynomial to sequential groups of data points. The number of data points used in the fit is specified by <strong>width</strong>.</p><p class="Body">For each peak or valley, the quadratic fit is tested against the <strong>threshold</strong>. Peaks with heights lower than the <strong>threshold</strong> or valleys with troughs higher than the <strong>threshold</strong> are ignored. Peaks and valleys are detected only after the VI processes approximately <strong>width</strong>/2 data points beyond the location of the peak or valley. This delay has implications only for real-time processing.</p><p class="Body">The Peak Detector VI must be notified when the first and last blocks are passed into the VI, so that the VI can initialize and then release data internal to the peak detection algorithm.</p><p class="Body">Refer to the following <a href="javascript:WWW(WWW_Peak_Detect)">support document</a> at <span class="Monospace">ni.com</span> for more information about peak detection using LabVIEW.</p><!--Module Specific Content--><script type="text/javascript">if (typeof(writeVarRefs)=="function"){writeVarRefs("249");}</script><!-- Example Information --><h2><a name="examples">Example</a></h2><p class="Body">Refer to the Peak Detection and Display VI in the <span class="Monospace">labview\examples\Signal Processing\Signal Operation</span> directory for an example of using the Peak Detector VI.</p><p class="Body"><a href="javascript:openVI('examples%5C%5CSignal%20Processing%5C%5CSignal%20Operation%5C%5CPeak%20Detection%20and%20Display.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3750);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p></div></body></HTML>