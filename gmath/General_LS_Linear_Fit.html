<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><!--Generated from database. Edit in the database; do not edit this file.--><!--VI id="871"--><HTML><head><!--LabVIEW VI path:vi.lib\Analysis\6fits.llb\General Linear Fit.vi--><TITLE>General Linear Fit VI</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="STYLESHEET" type="text/css" href="minimal.css"><script src="common.js" type="text/javascript"></script><script src="jquery-1.7.2.min.js" type="text/javascript"></script><script src="cssframes.js" type="text/javascript"></script><link media="print" rel="stylesheet" type="text/css" href="print.css"></head><body bgcolor="#ffffff"><noscript><p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p><hr width="100%" noshade></noscript><div id="styleDivTitle"><!-- VI or Function Name --><H1>General Linear Fit VI</H1><!--Owning Palette--><p class="Body"><strong>Owning Palette:</strong> <a href="../gmath/Curve_Fitting_VIs.html">Fitting VIs</a></p><!--Package and Platform--><p class="Body"><strong>Requires:</strong> Full Development System</p><!-- VI/Function Description --><p class="Body">Finds the <em>k</em>-dimension linear curve values and the set of <em>k</em>-dimension linear fit coefficients, which describe the <em>k</em>-dimension linear curve that best represents the input data set using the Least Square, Least Absolute Residual, or Bisquare method.</p><!-- Supplemental VI/Function Information --><!-- Link to Additional VI/Function Information --><p class="Body"><a href="#details">Details</a>&nbsp;&nbsp;<a href="#examples">Example</a></p><!-- Graphic Reference --><MAP NAME="connector_pane"><AREA SHAPE="rect" COORDS="0,9,104,18" HREF="#Input0"><AREA SHAPE="rect" COORDS="0,24,104,32" HREF="#Input1"><AREA SHAPE="rect" COORDS="0,38,104,46" HREF="#Input2"><AREA SHAPE="rect" COORDS="0,51,104,62" HREF="#Input3"><AREA SHAPE="rect" COORDS="0,65,104,74" HREF="#Input4"><AREA SHAPE="rect" COORDS="0,79,104,88" HREF="#Input5"><AREA SHAPE="rect" COORDS="0,93,104,104" HREF="#Input6"><AREA SHAPE="rect" COORDS="241,24,278,32" HREF="#Output0"><AREA SHAPE="rect" COORDS="241,37,299,46" HREF="#Output1"><AREA SHAPE="rect" COORDS="241,52,296,60" HREF="#Output2"><AREA SHAPE="rect" COORDS="241,65,297,76" HREF="#Output3"><AREA SHAPE="rect" COORDS="241,82,266,88" HREF="#Output4"><AREA SHAPE="rect" COORDS="241,93,277,102" HREF="#Output5"></MAP><p class="Anchor"><img src="General_LS_Linear_Fit.gif" usemap="#connector_pane" border="0"></p><!--Add/Find Buttons--><table class="Borderless"><tr><td><a href="javascript:placeObject(object871);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add to the block diagram</td><td><a href="javascript:findObject(object871);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find on the palette</td></tr></table></div><div id="styleDivScrolling"><!-- Table of VI/Function Parameters --><table class="Borderless"><tr><td class="Icon"><a name="Input0"></a><img src="cenum.gif"></td><td><strong>covariance selector</strong> indicates whether the VI computes the covariance matrix. <br><br><table class="Bordered"><tr><td class = "Bordered">0</td><td class = "Bordered">do not compute Covariance</td></tr><tr><td class = "Bordered">1</td><td class = "Bordered">compute Covariance</td></tr></table></td></tr><tr><td class="Icon"><a name="Input1"></a><img src="c1ddbl.gif"></td><td><strong>Y</strong> is the observed data set Y. The number of elements in <strong>Y</strong> must equal the number of rows in <strong>H</strong>. </td></tr><tr><td class="Icon"><a name="Input2"></a><img src="c2ddbl.gif"></td><td><!--Begin child: ../ptbypt/General_LS_Linear_Fit_Pt.html--><strong>H</strong> is the matrix that represents the formula you use to fit the data set (<strong>X</strong>, <strong>Y</strong>). <em>H<sub>ij</sub></em> are the function values of <em>X<sub>i</sub></em>.<!--End child: ../ptbypt/General_LS_Linear_Fit_Pt.html--> </td></tr><tr><td class="Icon"><a name="Input3"></a><img src="c1ddbl.gif"></td><td><strong>Weight</strong> is the array of weights for the observations <strong>Y</strong>. <strong>Weight</strong> must be the same size as <strong>Y</strong>. If you do not wire an input to <strong>Weight</strong>, this VI sets all elements of <strong>Weight</strong> to 1. <br><br>If an element in <strong>Weight</strong> is less than 0, this VI uses the absolute value of the element.</td></tr><tr><td class="Icon"><a name="Input4"></a><img src="cdbl.gif"></td><td><strong>tolerance</strong> determines when to stop the iterative adjustment of <strong>Coefficients</strong> when you use the Least Absolute Residual or Bisquare methods. For the Least Absolute Residual method, if the relative difference of the weighted mean error of the polynomial fit in two successive iterations is less than <strong>tolerance</strong>, this VI returns the resulting <strong>Polynomial Coefficients</strong>. For the Bisquare method, if any relative difference between <strong>Polynomial Coefficients</strong> in two successive iterations is less than <strong>tolerance</strong>, this VI returns the resulting <strong>Polynomial Coefficients</strong>. <br><br>If <strong>tolerance</strong> is less than or equal to 0, this VI sets <strong>tolerance</strong> to 0.0001.</td></tr><tr><td class="Icon"><a name="Input5"></a><img src="cu16.gif"></td><td><strong>method</strong> specifies the fitting method. <br><br><table class="Bordered"><tr><td class = "Bordered">0</td><td class = "Bordered">Least Square (default)</td></tr><tr><td class = "Bordered">1</td><td class = "Bordered">Least Absolute Residual</td></tr><tr><td class = "Bordered">2</td><td class = "Bordered">Bisquare</td></tr></table></td></tr><tr><td class="Icon"><a name="Input6"></a><img src="cu16.gif"></td><td><!--Begin child: ../ptbypt/General_LS_Linear_Fit_Pt.html--><strong>algorithm</strong> specifies the algorithm this VI uses to compute <strong>Best Fit</strong>.<!--End child: ../ptbypt/General_LS_Linear_Fit_Pt.html--> Use the <span class="Monospace">SVD for Rank Deficient H</span> algorithm only if <strong>H</strong> is rank deficient or does not have a full rank and if all other algorithms are unsuccessful. <br><br><table class="Bordered"><tr><td class = "Bordered">0</td><td class = "Bordered">SVD (default)</td></tr><tr><td class = "Bordered">1</td><td class = "Bordered">Givens</td></tr><tr><td class = "Bordered">2</td><td class = "Bordered">Givens2</td></tr><tr><td class = "Bordered">3</td><td class = "Bordered">Householder</td></tr><tr><td class = "Bordered">4</td><td class = "Bordered">LU Decomposition</td></tr><tr><td class = "Bordered">5</td><td class = "Bordered">Cholesky</td></tr><tr><td class = "Bordered">6</td><td class = "Bordered">SVD for Rank Deficient H</td></tr></table></td></tr><tr><td class="Icon"><a name="Output0"></a><img src="i1ddbl.gif"></td><td><strong>Best Fit</strong> is the fitted data computed by using <strong>Coefficients</strong>. </td></tr><tr><td class="Icon"><a name="Output1"></a><img src="i1ddbl.gif"></td><td><strong>Coefficients</strong> is the set of coefficients that minimize chi squared. The following equation defines <img src="chi.gif"><sup>2</sup>, where <img src="noloc_eq_coeff_denominator.gif"> is equal to the i-th element in <strong>Weight</strong>:<p class="Indent1"><img src="noloc_eq_gelslf12.gif"></p></td></tr><tr><td class="Icon"><a name="Output2"></a><img src="i2ddbl.gif"></td><td><strong>Covariance</strong> is the matrix of covariance <em>C</em> with <em>k</em>-by-<em>k</em> elements. c<sub>jk</sub> is the covariance between a<sub>i</sub> and a<sub>k</sub>. c<sub>jj</sub> is the variance of a<sub>j</sub>. This VI uses the following equation to compute the covariance matrix <em>C</em>:<p class="Indent1"><em>C</em> = (<em>H</em><sub>0</sub><sup><em>T</em></sup><em>H</em><sub>0</sub>)<sup>&#8211;1</sup></p></td></tr><tr><td class="Icon"><a name="Output3"></a><img src="i1ddbl.gif"></td><td><strong>Weight Out</strong> returns the actual weight of general linear fitting if <strong>method</strong> is <span class="Monospace">Bisquare</span>. If <strong>method</strong> is <span class="Monospace">Least Square</span> or <span class="Monospace">Least Absolute Residual</span>, <strong>Weight Out</strong> returns the value you enter for <strong>Weight</strong>. </td></tr><tr><td class="Icon"><a name="Output4"></a><img src="ii32.gif"></td><td><strong>error</strong> returns any <a href="../lverror/Error_Code_Ranges.html">error</a> or warning from the VI. You can wire <strong>error</strong> to the <a href="../glang/Err_Cluster_from_Code.html">Error Cluster From Error Code</a> VI to convert the error code or warning into an error cluster. </td></tr><tr><td class="Icon"><a name="Output5"></a><img src="idbl.gif"></td><td><strong>residue</strong> returns the weighted mean error of the fitted model. If <strong>method</strong> is <span class="Monospace">Least Absolute Residual</span>, <strong>residue</strong> is the weighted mean absolute error. Otherwise, <strong>residue</strong> is the weighted mean square error. </td></tr></table><!-- Additional VI/Function Information --><h2><a name="details">General Linear Fit Details</a></h2><p class="Body">The following linear data model demonstrates how to configure the input parameters and how to use the General Linear Fit VI to obtain the fitted values and the set of least square coefficients a that best represents the relationship of observations (X, Y):</p><p class="Indent1"><img src="noloc_eq_glslfdet1.gif"></p><p class="Body">where</p><p class="Indent1"><em>a</em> = {<em>a</em><sub>0</sub>, <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, &#8230;, <em>a</em><sub><em>n</em> &#8211; 1</sub>}</p><p class="Indent1"><em>n</em> is the total number of functions</p><p class="Indent1"><em>f</em><sub><em>i</em></sub>(<em>x</em>) are modal functions</p><p class="Body">Assume you have a set of observations (X, Y). For example, you can obtain a set of observations through data acquisition. Also, assume you think the relationship between x and y is of the form</p><p class="Indent1">y = a<sub>0</sub>f<sub>0</sub>(x) + a<sub>1</sub>f<sub>1</sub>(x) + a<sub>2</sub>f<sub>2</sub>(x) + a<sub>3</sub>f<sub>3</sub>(x) + a<sub>4</sub>f<sub>4</sub>(x)</p><p class="Body">where</p><p class="Indent1"><img src="noloc_eq_glslf6.gif"></p><p class="Body">To obtain the coefficients <em>a</em>, you first obtain the matrix H, as shown in the following block diagram.</p><p class="Anchor"><img src="loc_bd_computeh.gif"></p><p class="Body">Then you obtain the coefficients <em>a</em>, as shown in the following block diagram.</p><p class="Anchor"><img src="loc_bd_fittingcoefs.gif"></p><p class="Body">The following block diagram shows the general programming flow for general linear fitting.</p><p class="Anchor"><img src="loc_bd_flow.gif"></p><!--Module Specific Content--><script type="text/javascript">if (typeof(writeVarRefs)=="function"){writeVarRefs("871");}</script><!-- Example Information --><h2><a name="examples">Example</a></h2><p class="Body">Refer to the Predicting Cost VI in the <span class="Monospace">labview\examples\Mathematics\Fitting</span> directory for an example of using the General Linear Fit VI.</p><p class="Body"><a href="javascript:openVI('examples%5C%5CMathematics%5C%5CFitting%5C%5CPredicting%20Cost.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3739);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p></div></body></HTML>