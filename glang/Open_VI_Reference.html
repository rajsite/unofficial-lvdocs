<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><head><!--Generated from database. Edit in the database; do not edit this file.--><!--Function id="708"--><TITLE>Open VI Reference Function</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252"><meta http-equiv="Content-Style-Type" content="text/css"><link rel="STYLESHEET" type="text/css" href="minimal.css"><script src="common.js" type="text/javascript"></script><script src="jquery-1.7.2.min.js" type="text/javascript"></script><script src="cssframes.js" type="text/javascript"></script><link media="print" rel="stylesheet" type="text/css" href="print.css"></head><body bgcolor="#ffffff"><noscript><p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p><hr width="100%" noshade></noscript><div id="styleDivTitle"><!-- VI or Function Name --><H1>Open VI Reference Function</H1><!--Owning Palette--><p class="Body"><strong>Owning Palette:</strong> <a href="../glang/Appl_Control_VI_and_Func.html">Application Control VIs and Functions</a></p><!--Package and Platform--><p class="Body"><strong>Requires:</strong> Base Development System</p><!-- VI/Function Description --><p class="Body">Returns a reference to a VI, custom control, or global variable specified by a name string or path to the VI location on disk.</p><!-- Supplemental VI/Function Information --><!-- Link to Additional VI/Function Information and Examples  --><p class="Body"><a href="#details">Details</a>&nbsp;&nbsp;<a href="#examples">Examples</a></p><!-- Graphic Reference --><MAP NAME="connector_pane"><AREA SHAPE="rect" COORDS="0,12,155,23" HREF="#Input0"><AREA SHAPE="rect" COORDS="0,27,155,38" HREF="#Input1"><AREA SHAPE="rect" COORDS="0,41,155,52" HREF="#Input2"><AREA SHAPE="rect" COORDS="0,56,155,66" HREF="#Input3"><AREA SHAPE="rect" COORDS="0,69,155,80" HREF="#Input4"><AREA SHAPE="rect" COORDS="0,83,155,94" HREF="#Input5"><AREA SHAPE="rect" COORDS="262,27,323,36" HREF="#Output0"><AREA SHAPE="rect" COORDS="262,52,307,60" HREF="#Output1"></MAP><p class="Anchor"><img src="openvi.gif" usemap="#connector_pane" border="0"></p><!--Add/Find Buttons--><table class="Borderless"><tr><td><a href="javascript:placeObject(object708);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add to the block diagram</td><td><a href="javascript:findObject(object708);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find on the palette</td></tr></table></div><div id="styleDivScrolling"><!-- Table of VI/Function Parameters --><table class="Borderless"><tr><td class="Icon"><a name="Input0"></a><img src="cdvrn.gif"></td><td><strong>type specifier VI Refnum (for type only)</strong> determines the connector pane information and data type of <strong>vi reference</strong>. LabVIEW ignores the actual value of this input. By default, the function returns a Generic VI reference.<br><br>If you want to use the <strong>vi reference</strong> output of this function with the Call By Reference node or the Start Asynchronous Call node, you must <a href="../lvhowto/Create_Strict_Type_VI_Ref.html">wire a strictly typed VI reference</a> to this input.<br><br>If you wire a strictly typed VI reference to this input, the connector pane of the VI specified by <strong>vi path</strong> must match the connector pane of this input.</td></tr><tr><td class="Icon"><a name="Input1"></a><img src="cdvrn.gif"></td><td><strong>application reference</strong> is a reference to a LabVIEW <a href="../lvconcepts/Application_Instances.html">application instance</a>. By default, LabVIEW uses the application instance of the calling VI. You can obtain references to other application instances with the <a href="../glang/Open_Application_Reference.html">Open Application Reference</a> function. If you wire a reference to another application instance to the <strong>application reference</strong> input, <strong>vi path</strong> refers to a location in the file system of the computer that is running that application instance.</td></tr><tr><td class="Icon"><a name="Input2"></a><img src="cpath.gif"></td><td><strong>vi path</strong> accepts a string containing the name of the VI that you want to reference or a <a href="../glang/Path_Constant.html">path</a> to the VI that you want to reference. If you wire a name string, the string must match the full delimited name of a VI in memory on that target. If you wire a path, LabVIEW searches for a VI in memory that you previously loaded from that path on the same target. If a matching VI is not found in memory, LabVIEW then tries to load the VI from that file on disk. An error occurs if LabVIEW cannot find the file.<br><br>If the path is relative, the VI interprets the path as relative to the caller VI or to the application directory, if the caller VI is not saved.<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;If you specify a remote application instance with <strong>application reference</strong>, the path is interpreted on the remote machine in the context of the remote file system. The path is expressed using the local computer's path separators, but is translated to the remote computer's path separators when the request arrives there.<br><br>For example, to reference a VI on macOS at <span class="Monospace">My HD/LabVIEW Vis/foo.vi</span> from a Windows&#8211;based application, use the path <span class="Monospace">My HD:\LabVIEW Vis\foo.vi</span>. Conversely, to reference a VI on a computer running Windows at <span class="Monospace">C:\labview\foo.vi</span> from an macOS application, wire the path <span class="Monospace">C/labview/foo.vi</span>.</td></tr></table>If you wire a path, LabVIEW waits until the user interface is idle to load the VI from disk. If you wire a name string, LabVIEW does not need to wait until the user interface is idle, as it does not load a VI from disk. LabVIEW will only search in memory for a VI with a specified name.<br><table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp; LabVIEW does not support the ability to open a reference to a clone VI with the Open VI Reference function. Using this function to open a reference to a clone VI may cause LabVIEW to crash.</td></tr></table></td></tr><tr><td class="Icon"><a name="Input3"></a><img src="ci32.gif"></td><td><a name="options"></a><strong>options</strong> determines characteristics of the VI referenced by <strong>vi reference</strong>, including whether you can call the VI asynchronously. The default is <span class="Monospace">0x0</span>. Create <strong>options</strong> by <a href="../lvhowto/combining_options.html">combining a subset of the following option flags.</a><table class="Bordered"><tr><td class="Bordered">Option flag</td><td class="Bordered">Description</td></tr><tr><td class="Bordered">0x01</td><td class="Bordered"><strong>Record modifications</strong>&#8212;Use this option flag when you want an asterisk (*) to appear by the VI title when changes have been made using VI Server. The VI must be in edit mode for LabVIEW to record the modifications.</td></tr><tr><td class="Bordered">0x02</td><td class="Bordered"><strong>Open templates for editing</strong>&#8212;Use this option flag to open the original <span class="Monospace">.vit</span> file. If you do not select this option flag, LabVIEW opens a new instance of the template VI. Edits made to an instance do not affect the original <span class="Monospace">.vit</span> file. This option flag has no effect on non-template files.</td></tr><tr><td class="Bordered">0x04</td><td class="Bordered"><strong>Prompt user to save</strong>&#8212;Use this option flag to prompt the user to save changes when this VI reference closes if all the following conditions are true: <ul><li>The referenced VI or its subVIs contain unsaved changes.</li><!--begin parent: ../glang/Close_LV_Object_Reference.html, axprop.chm://GetVIReference.html, ../lvconcepts/Building_VI_Server_Applications.html--><li>There are no other open references to the referenced VI.</li><!--end parent: ../glang/Close_LV_Object_Reference.html, axprop.chm://GetVIReference.html, ../lvconcepts/Building_VI_Server_Applications.html--><li>The referenced VI is able to leave memory. A VI is able to leave memory, for example, if no other VIs call the VI, the front panel of the VI is closed, and the VI is not a member of an open project library, and so on.</li></ul></td></tr><tr><td class="Bordered">0x08</td><td class="Bordered"><strong>Prepare for <a href="../lvconcepts/reentrancy.html">reentrant</a> run</strong>&#8212;Use this option flag when you want a reference to a reentrant clone of the target VI, instead of the target VI itself. Reentrant clones of a VI allow you to open multiple front panels of the same VI or to run multiple copies of the same VI in parallel. For each reference to the target VI, LabVIEW creates a separate clone of the target VI. This clone is not part of the pool of shared clones used by regular subVI calls.<BR><BR>LabVIEW ignores this flag if you wire the <strong>type specifier VI Refnum (for type only)</strong> input because when you provide a type specifier, you can always get a reentrant clone if the target VI is reentrant. LabVIEW returns error 1096 if the target VI is not reentrant.<table class="Borderless"><tr><td class="Icon"><img src="tip.gif"></td><td><strong>Tip</strong>&nbsp;&nbsp;Use this flag in combination with the <a href="../lvprop/VI_Run_VI.html">Run VI</a> method to execute multiple reentrant clones in parallel. Use the <a href="../glang/start_asynchronous_call.html">Start Asynchronous Call</a> node instead of the Run VI method to run target VIs asynchronously. In addition to providing a simpler interface and better performance, the Start Asynchronous Call node allows you to collect the outputs of the target VI with a corresponding <a href="../glang/wait_on_asynchronous_call.html">Wait On Asynchronous Call</a> node.</td></tr></table></td></tr><tr><td class="Bordered">0x10</td><td class="Bordered"><strong>Prompt to find missing subVIs</strong>&#8212;Use this option flag to prompt the user to allow LabVIEW to search for missing subVIs of the referenced VI.</td></tr><tr><td class="Bordered">0x20</td><td class="Bordered"><strong>Hide loading dialog box</strong>&#8212;Prevents LabVIEW from displaying the loading dialog box when searching for missing subVIs of the referenced VI. <table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;This option flag does not affect whether LabVIEW prompts you to find the missing VIs or not.</td></tr></table></td></tr><tr><td class="Bordered">0x40</td><td class="Bordered"><strong>Enable simultaneous calls on reentrant VIs</strong>&#8212;Use this option flag when you want to use multiple Call By Reference or Start Asynchronous Call nodes to execute clones of a reentrant target VI in parallel, as when you use these nodes within a For Loop with <a href="../lvconcepts/VI_Execution_Speed.html#Parallel_For_Loop_Iterations">parallel loop iterations</a>. This option flag enables parallel execution because it gives each Call By Reference node access to the data spaces of the clone VIs. If you do not use this option flag, calls to the same target VI execute one at a time because they must wait for access to the same data space.<br><br>The 0x40 option flag is valid only in the following situations:<ul><li>The target VI is reentrant and <a href="../lvconcepts/reentrancy.html">shares clones</a>.</li><li>The target VI is reentrant, and you also include either the 0x80 or the 0x100 option flag.</li></ul><table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;LabVIEW returns error 1591 if the 0x40 option flag is not valid for the target VI or the other included option flags.</td></tr></table></td></tr><tr><td class="Bordered">0x80</td><td class="Bordered"><strong>Prepare to call and forget</strong>&#8212;Use this option flag when you want to call a target VI asynchronously with the Start Asynchronous Call node but you do not need to know when or what the VI returns. Do not use this option flag with 0x08 or 0x100.<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;LabVIEW returns error 1578 if you use this option flag with a reference to a remote VI.</td></tr></table></td></tr><tr><td class="Bordered">0x100</td><td class="Bordered"><strong>Prepare to call and collect</strong>&#8212;Use this option flag when you want to collect the results of an asynchronous call to a target VI with the Wait On Asynchronous Call node. If you use this option flag, you must include one Wait On Asynchronous Call node for every call that you begin with a Start Asynchronous Call node to ensure that LabVIEW does not retain any started calls in memory indefinitely. Do not use this option flag with  0x08 or 0x80.<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;LabVIEW returns error 1578 if you use this option with a reference to a remote VI.</td></tr></table></td></tr></table></td></tr><tr><td class="Icon"><a name="Input4"></a><img src="cerrcodeclst.gif"></td><td><strong>error in</strong> describes error conditions that occur before this node runs. This input provides <a href="../lvconcepts/using_standard_error_in.html">standard error in</a> functionality. </td></tr><tr><td class="Icon"><a name="Input5"></a><img src="cstr.gif"></td><td><strong>password</strong> is the password for the VI whose reference you want to open. Wire a password to this input if you want to edit a password-protected target VI. If you wire the correct password, the function returns an authenticated reference to the VI. If you wire an incorrect password to this input, the function returns an error and an invalid VI reference. LabVIEW ignores this input if the target VI is not password-protected. If you do not wire a password to this input and the target VI is password-protected, the Open VI Reference function returns a valid reference, but you cannot use the reference to edit the VI.<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp; You can also use a <a href="../glang/Control_Reference.html">VI Server Reference</a> to get an authenticated reference to a VI.</td></tr></table></td></tr><tr><td class="Icon"><a name="Output0"></a><img src="idvrn.gif"></td><td><strong>vi reference</strong> is the refnum associated with the requested VI. If the function fails, <strong>vi reference</strong> contains <span class="Monospace">Not A Refnum</span>.</td></tr><tr><td class="Icon"><a name="Output1"></a><img src="ierrcodeclst.gif"></td><td><strong>error out</strong> contains error information. This output provides <a href="../lvconcepts/using_standard_error_out.html">standard error out</a> functionality. </td></tr></table><!-- Additional VI/Function Information --><h2><a name="details">Open VI Reference Details</a></h2><p class="Body">The Open VI Reference function prepares a VI reference for dynamic calls by the <a href="../glang/Call_By_Reference_Node.html">Call By Reference</a> node, the <a href="../glang/start_asynchronous_call.html">Start Asynchronous Call</a> node, and the <a href="../glang/wait_on_asynchronous_call.html">Wait On Asynchronous Call</a> node. Use the <strong>type specifier VI Refnum (for type only)</strong> and the <strong>options</strong> inputs to prepare a reference for dynamic execution.</p><h3>Opening References for Dynamic VI Calls</h3><p class="Body">If you want to call the specified VI dynamically with the Call By Reference Node or the Start Asynchronous Call Node, you must use appropriate data for the following parameters:</p><ul><li><strong>type specifier VI Refnum (for type only)</strong>&#8212;Wire a strictly typed VI reference to this input.</li><li><strong>options</strong>&#8212;Determine whether the 0x08, 0x40, 0x80, and 0x100 option flags apply to the way you want to call the referenced VI.</li></ul><h3>Criteria for Opening Strictly Typed References</h3><p class="Body">If you wire a strictly typed VI reference to the <strong>type specifier VI Refnum (for type only)</strong>, the VI specified by <strong>vi path</strong> must meet the following criteria:</p><ul><li>The VI cannot be broken.</li><li>The VI cannot be active as a top-level VI unless the VI is reentrant.</li><li>The connector pane of the VI must match the connector pane of <strong>type specifier VI Refnum (for type only)</strong>.</li></ul><h3>Opening References to Reentrant VIs</h3>If you open a reference to a reentrant VI, consider the following details:<ul><li>Dynamic calls to reentrant target VIs execute serially unless you specify 0x40 as one of the <strong>options</strong>.</li><li>If you use the 0x40 option flag to execute instances of a reentrant target VI in parallel, <strong>vi reference</strong> refers to the target VI rather than to a clone of the target VI. However, both the Call By Reference node and the Start Asynchronous Call node call a clone of the target VI. Therefore, if you call a VI Server property or method on <strong>vi reference</strong>, the property or method does not affect the clone VIs that those nodes actually call.</li><li>The <a href="../glang/Equal.html">Equal?</a> function always returns TRUE when you compare two references to the same reentrant VI. To determine whether the references refer to the same instance of the reentrant VI, use the Type Cast function to convert the references to 32-bit signed integers. Then use the Equal? Function to compare those integers.</li></ul><h3>Aborting Open References</h3><p class="Body">You can abort all open VI references either manually from the front panel of the VI or by using the <a href="../lvprop/VI_Abort_VI.html">Abort VI</a> method. However, VI references prepared for asynchronous execution have important caveats depending on the <strong>options</strong> used to open the reference:</p><ul><li>0x80&#8212;A call-and-forget VI aborts only if you manually abort it from its front panel or call the <a href="../lvprop/VI_Abort_VI.html">Abort VI</a> method on it. Otherwise, the VI runs to completion, even if you close the reference or abort the calling VI.</li><li>0x100&#8212;Call-and-collect VIs abort for the following reasons:<ul>		<li>You abort the VI that opened the call-and-collect VI reference. In this case, LabVIEW aborts all running instances of the VI.</li>		<li>You manually abort a specific instance of the VI. In this case, exactly one Wait On Asynchronous Call node returns an error indicating that the called VI aborted. All other Wait On Asynchronous Call nodes that are waiting on calls to the same VI reference continue waiting.</li>		<li>You call the <a href="../lvprop/VI_Abort_VI.html">Abort VI</a> method on the call-and-collect VI reference. In this case, LabVIEW aborts all currently running instances of the VI. A corresponding number of Wait On Asynchronous Call nodes return errors.</li></ul></li></ul><h3>Closing Open References</h3><p class="Body">After you finish using a reference that you obtain with this function, close the reference with the <a href="../glang/Close_LV_Object_Reference.html">Close Reference</a> function. Explicitly closing a reference enables LabVIEW to free the resources involved in maintaining that reference, thereby contributing to optimal memory allocation and performance. Otherwise, LabVIEW cannot close the reference until the VI that opened the reference finishes executing.</p><table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;Closing a reference that was opened with the 0x80 option flag does not abort the referenced VI.</td></tr></table><h3>Opening a VI Reference in a Stand-Alone Application</h3><p class="Body">If you want to dynamically open a VI on both the development computer and <a href="../lvconcepts/referencing_files_in_applications.html">within a stand-alone application</a>, use a relative path for <strong>vi path</strong>.</p><h3>Miscellaneous Details</h3><ul><li>If you set the <a href="../lvprop/VI_ExeRun_When_Opened.html">Execution:Run When Opened</a>, <a href="../lvprop/VI_ExeShw_FP_On_Load.html">Execution:Show Front Panel On Load</a>, or <a href="../lvprop/VI_ExeShw_FP_On_Call.html">Execution:Show Front Panel On Call</a> properties or the corresponding options in the <a href="../lvdialog/VI_Properties_Dialog_Box.html">VI Properties</a> dialog box of the target VI, LabVIEW ignores the settings.</li><li>To open a new <a href="../lvconcepts/Creating_an_XControl_Facade.html">Facade VI</a> reference, wire a FacadeVI class to <strong>type specifier VI Refnum (for type only)</strong>. </li></ul><!--Module Specific Content--><script type="text/javascript">if (typeof(writeVarRefs)=="function"){writeVarRefs("708");}</script><!-- Example Information --><h2><a name="examples">Examples</a></h2><p class="Body">Refer to the following VIs for examples of using the Open VI Reference function:</p><ul><li>Asynchronous Call and Collect (Using Option 0x40) VI: <span class="Monospace">labview\examples\Application Control\VI Server\Asynchronous Call By Reference</span><p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Server%5C%5CAsynchronous%20Call%20By%20Reference%5C%5CAsynchronous%20Call%20and%20Collect%20(Using%20Option%200x40).vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3072);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p></li><li>Asynchronous Call and Forget VI: <span class="Monospace">labview\examples\Application Control\VI Server\Asynchronous Call By Reference</span><p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Server%5C%5CAsynchronous%20Call%20By%20Reference%5C%5CAsynchronous%20Call%20and%20Forget.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3072);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p></li><li>Asynchronous Call and Collect VI: <span class="Monospace">labview\examples\Application Control\VI Server\Asynchronous Call By Reference</span><p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Server%5C%5CAsynchronous%20Call%20By%20Reference%5C%5CAsynchronous%20Call%20and%20Collect.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3072);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p></li></ul></div></body></HTML>