<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>


<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">

<title>Importing Functions from a Shared Library File</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script>





</head>

<body bgcolor="#ffffff">
<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript>
			<h1>Importing Functions from a Shared Library File</h1>
					<p class="Body">Use the <a href="../lvdialog/import_library_wizard.html">Import Shared Library</a> wizard to create or update a LabVIEW project library of wrapper VIs for functions in a Windows <span class="Monospace">.dll</span> file, a macOS <span class="Monospace">.framework</span> file, or a Linux <span class="Monospace">.so</span> file. You must provide the name of a shared library file and a header (<span class="Monospace">.h</span>) file for the wizard to parse. The <strong>Import Shared Library</strong> wizard supports only header files that are compatible with C/C++ syntax and use the C or Standard (<span class="Monospace">_stdcall</span>) <a href="../lvexcodeconcepts/Calling_External_APIs.html">calling convention</a>.</p>
					<p class="Body">Complete the following steps to create or update wrapper VIs for functions in a shared library file. </p>
					<ol><li>Select <strong>Tools&#0187;Import&#0187;Shared Library</strong><!--Elana: per CAR 39959, we document this shortcut menu item as Shared Library without the file extension b/c the file extension changes for different platforms --> to launch the <strong>Import Shared Library</strong> wizard. The <a href="../lvdialog/create_vi_wrapper.html">Specify Create or Update Mode</a> page appears.</li><li>If you want to create wrapper VIs for a shared library you did not import previously, select <strong>Create VIs for a shared library</strong>.  If you want to update wrapper VIs for a shared library that you did import previously, select <strong>Update VIs for a shared library</strong> and select the library from the list.</li></ol> 
					<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;When you select the <strong>Update VIs for a shared library</strong> option, the wizard overwrites the previously-generated project library file and the existing VIs within that project library file. If you choose not to re-import generated VIs within the project library file, the VIs remain unchanged in the directory. The wizard retains the most recent settings for each individual function in a particular shared library. For example, if you have a shared library that contains three functions, you might update only the second function. The next time you run the wizard on that shared library file, it retains the original settings for functions one and three and the new settings for function two.</td></tr></table>
					<ol start="3">
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_select_dll.html">Select Shared Library and Header File</a> page of the wizard.</li>
						<li>Enter the path to the shared library file you want to import in the <strong>Shared Library File</strong> text box, or click the <strong>Browse</strong> button to navigate to and select the file.</li>
						<li>If you want to create VIs for a shared library that is not available on the local computer, such as if the shared library exists on an RT target, place a checkmark in the <strong>Shared library file is not on the local machine</strong> checkbox and enter the filename of the shared library file in the <strong>Shared Library File</strong> text box. You do not have to enter the path to the shared library file.</li>
					</ol>
					<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;If you specify only a filename and not a path, the shared library file must be in the destination directory for the wrapper VIs or it must be available through the system search path. </td></tr></table>
					<ol start="6">
						<li>Enter the path to the header file that you want to use with the shared library in the <strong>Header (.h) File</strong> text box, or click the <strong>Browse</strong> button to navigate to and select the file. The <strong>Import Shared Library</strong> wizard supports only header files that are compatible with C/C++ syntax and use the C or standard (WINAPI) calling convention.</li>
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_config_paths.html">Configure Include Paths and Preprocessor Definitions</a> page, and enter any include paths or preprocessor definitions you want the wizard to use when it parses the header file.</li>
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_select_func.html">Select Functions to Convert</a> page. A dialog box appears to notify you that LabVIEW is parsing the header file.</li>
						<li>The <strong>Select Functions to Convert</strong> page displays all the functions found in the shared library. If the wizard cannot import a function, the function appears in the list with a black <img src="noloc_env_funcerrorx.gif"> glyph beside the item name. Select the function to display possible reasons for the error.</li> 
					</ol>
					<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;If you selected the <strong>Shared library file is not on the local machine</strong> option, this page lists only the functions declared in the header file. If you did not select the <strong>Shared library file is not on the local machine</strong> option, this page also lists functions referenced in the shared library file that are not declared in the header file.</td></tr></table>
					<ol start="10">
						<li>(Optional) If the wizard cannot import one or more functions, click the <strong>Back</strong> button to add, remove, or update existing include paths or preprocessor definitions. If the errors are extensive, consider cancelling out of the wizard and editing the header file to be sure the file is well-formed before using the <strong>Import Shared Library</strong> wizard to generate wrapper VIs. </li>
						<li>On the <strong>Select Functions to Convert</strong> page, select the functions you want to convert by placing a checkmark in the checkbox beside each function. Click the <strong>Check All</strong> button if you want to create wrapper VIs for all the functions in the list.</li>
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_config_projlib.html">Configure Project Library Settings</a> page.</li>
						<li>Enter a name for the project library file you want to create in the <strong>Project Library Name (.lvlib)</strong> text box. LabVIEW automatically includes all generated VIs within this project library file and uses a <span class="Monospace">.lvlib</span> extension for the file.</li>
						<li>Enter the path to the directory in which you want to save the files the wizard generates in the <strong>Project Library Path</strong> text box. You also can click the <strong>Browse</strong> button to navigate to and select the directory.</li>
						<li>(Optional) If you want to save a copy of the original shared library file in the destination directory, place a checkmark in the <strong>Copy the shared library file to the destination directory</strong> checkbox.</li>
					</ol>
					<table class="Borderless"><tr><td class="Icon"><img src="note.gif"></td><td><strong>Note</strong>&nbsp;&nbsp;The wizard copies only the shared library file you specify. It does not copy any dependent shared library files. To ensure that the generated VIs are not broken, manually copy all dependent shared library files to the destination folder or add them to the system search path.</td></tr></table>
					<ol start="16">
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_error_handle.html">Select Error Handling Mode</a> page.</li>
						<li>Select the error handling mode you want to use for the majority of the wrapper VIs from the <strong>Error Handling Mode</strong> pull-down menu. The <strong>Example Block Diagram</strong> field shows the basic block diagram the wizard generates for the wrapper VIs. If you want to select multiple error handling modes, you can re-run the wizard, select the <strong>Update VIs for a shared library</strong> option, and regenerate only the VIs for which you want to use a different error handling mode.</li>
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_config_VIs.html">Configure VIs and Controls</a> page.</li>
						<li>Review the configuration for the VIs and controls you want to create. Use the options on the <strong>Settings</strong> and <strong>Name and Description</strong> tabs to edit specific VI and control information for the majority of VIs you want to generate. An icon represents the data type for each control. An exclamation point <img src="noloc_env_unsupport.gif"> glyph appears beside any data types that LabVIEW cannot process. For data types that LabVIEW does not support, <a href="../lvhowto/Creating_Type_Defs.html">create a custom control</a> and add the control to the generated library after you complete the wizard.</li>
						<li>Click the <strong>Next</strong> button to display the <a href="../lvdialog/DLL_gen_summary.html">Generation Summary</a> page.</li>
						<li>Review the <strong>Generation Summary</strong>. If you want to make any changes, click the <strong>Back</strong> button to navigate back through the wizard.</li>
						<li>On the <strong>Generation Summary</strong> page, click the <strong>Next</strong> button to create wrapper VIs for the functions you selected in the specified shared library file. The <strong>Generation Progress</strong> page shows the progress of the wizard as it generates the wrapper VIs. When the generation completes, the <a href="../lvdialog/DLL_finish.html">Finish</a> page appears.</li>
						<li>Place a checkmark in the <strong>Open the generated library</strong> checkbox if you want to open the generated library file when the wizard closes.</li>
						<li>Place a checkmark in the <strong>View the report</strong> checkbox if you want to view a generation report when the wizard closes. If you select this option, the report opens in the default Web browser.</li>
						<li>Click the <strong>Finish</strong> button to close the wizard.</li>
						<li>Review the project library file and the generated wrapper VIs. If you selected an error handling mode that calls a separate error handling VI, you must open the error VI and modify it.</li></ol>
					<p class="Body">Refer to  <a href="example_import_shared_library.html">Example: Importing Functions from a Shared Library File</a> to create and update a library of VIs based on the functions included in an example shared library file, <span class="Monospace">ImportSharedLibraryExample.dll</span>.</p>


</body>
</html>
