<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>


<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<!-- Unit name: 6100Ecommhlp -->

<title>Programmatically Opening and Closing Data Connections</title>
<meta http-equiv="Content-Style-Type" content="text/css"><link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script>





</head>
<body bgcolor="#ffffff">

<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript>

<h1>Programmatically Opening and Closing Data Connections</h1>

<p class="Body">Use the DataSocket Open and DataSocket Close functions to open and close data connections programmatically.</p>

<p class="Body">Complete the following steps to open and close a data connection programmatically.</p>

<ol><li>Add the <a href="../lvcomm/DataSocket_Open.html">DataSocket Open</a> function to the block diagram.<br><br>
<SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object1491);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> <SPAN title=" Find on the palette "><a href="javascript:findObject(object1491);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN>
</li>
<li>Wire a <span class="Monospace">psp</span> <a href="../lvconcepts/Using_DataSocket_Technology.html#Specifying_a_URL">URL</a> to the <strong>URL</strong> input or wire a <a href="../lvhowto/I_O_Controls.html">shared variable control</a> to the <strong>URL</strong> input.</li>
<li>Right-click the <strong>mode</strong> input and select <strong>Create&#0187;Constant</strong> from the shortcut menu.</li>
<li>Click the <strong>mode</strong> constant and select <span class="DNL"><strong>Read</strong></span> (0), <span class="DNL"><strong>Write</strong></span> (1), <span class="DNL"><strong>ReadWrite</strong></span> (2), <span class="DNL"><strong>BufferedRead</strong></span> (3), or <span class="DNL"><strong>BufferedReadWrite</strong></span> (4).  You also can use the <a href="../lvprop/Ctrl_DatSockMode.html">DataSocket:Mode</a> property to set the data connection mode programmatically.</li>

<li>Add one of the following functions to the block diagram and create controls or constants for the appropriate inputs:
<ul><li><a href="../lvcomm/DataSocket_Read.html">DataSocket Read</a> function<br><br>
<SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object556);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> <SPAN title=" Find on the palette "><a href="javascript:findObject(object556);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></li>
<li><a href="../lvcomm/DataSocket_Write.html">DataSocket Write</a> function<br><br>
<SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object559);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> <SPAN title=" Find on the palette "><a href="javascript:findObject(object559);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></li></ul></li>
<li>Wire the <strong>connection id</strong> output of the DataSocket Open function to the <strong>connection in</strong> input of the DataSocket Read or DataSocket Write function.
</li>
<li>Add a <a href="../lvcomm/DataSocket_Close.html">DataSocket Close</a> function to the block diagram.<br><br>
<SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object1492);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> <SPAN title=" Find on the palette "><a href="javascript:findObject(object1492);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></li>
<li>Wire the <strong>connection out</strong> output of the DataSocket Read or DataSocket Write function to the <strong>connection id</strong> input of the DataSocket Close function to close the data connection. The connection also closes when the VI stops.</li>
<li><a href="Setting_Up_Error_I_O_in_VI.html">Wire all error in and error out terminals</a> on the block diagram.</li>
</ol>



</body>
</html>