<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="common.js" type="text/javascript"></script><script src="dynamicjumps.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script><title>Configuring a Connector Pane Using VI Scripting</title>
</head>
<body>
<h1>Configuring a Connector Pane Using VI Scripting</h1>
<p><strong>Requires:</strong> <a href="enabling_vi_scripting.html">VI Scripting</a></p>
<p>You can use VI Scripting to interact with the connector pane of a VI programmatically to accomplish any of the following tasks:</p>
<ul>
	<li>Selecting a connector pane pattern for a subVI</li>
	<li>Assigning a control to a terminal on a connector pane</li>
	<li>Navigating across a connector pane</li>
	<li>Defining whether a terminal of a subVI is required, optional, or recommended</li>
</ul>
<p>This topic highlights the first two tasks. Refer to the <a href="../lvscript/ConnectorPane_m.html">Connector Pane</a> methods for more information about interacting with a connector pane programmatically.</p>
<p class="Body"></p>

<a name="whatYouNeed"></a><h2>What to Use</h2>
<p>This VI Scripting task requires the following objects:</p>
<table class="Usage">
	<col class="Object"/>
	<col class="Spacer"/>
	<col class="Object"/>
	<col class="Spacer"/>
	<col class="Object"/>
	<col class="Spacer"/>
	<col class="Object"/>
	<tr><td><a href="../lvscript/VI_Connector_Pane058Reference.html">VI:Connector Pane:Reference</a></td>
		<td></td>
		<td><a href="../lvscript/ConnectorPane_Pattern.html">ConnectorPane:Pattern</a></td>
		<td></td>
		<td><a href="../lvscript/ConnPane_AssgCtrlToTerm.html">ConnectorPane:Assign Control To Terminal</a></td>
		<td></td>
		<td>Connector Pane Pattern Reference Example</td>
	</tr>
	<tr>
		<td><img src="loc_bd_ConnectorPaneReference.gif"></td>
		<td></td>
		<td><img src="loc_bd_ConnectorPanePattern.gif"></td>
		<td></td>
		<td><img src="loc_bd_ConnectorPaneAssign.gif"></td>
		<td></td>
		<td><img src="noloc_fp_patternExample.gif"></td>
	</tr>
	<tr>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object725);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> </td><td>
<SPAN title=" Find on the palette "><a href="javascript:findObject(object725);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object725);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN></td><td> 
<SPAN title=" Find on the palette "><a href="javascript:findObject(object725);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object727);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN></td><td> 
<SPAN title=" Find on the palette "><a href="javascript:findObject(object727);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td>
			<a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Scripting%5C%5CConnector%20Pane%5C%5CConnector%20Pane%20Pattern%20Reference.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example
		</td>
	</tr>
</table>


<a name="how"></a><h2>What to Do</h2>
<p><strong>Before you start: </strong>Open the Add Terminals to Connector Pane VI in the <span class="Monospace">labview\examples\Application Control\VI Scripting\Connector Pane</span> directory for an example that illustrates each step of the following procedure.</p>
<a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Scripting%5C%5CConnector%20Pane%5C%5CAdd%20Terminals%20to%20Connector%20Pane.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open Example
<p>Expand the procedure for more information about this specific example.</p>


<input type="button" onclick="openAll()" value="Expand All"><input type="button" onclick="closeAll()" value="Collapse All">

<ol>
	<li><a href="../lvhowto/scripting_obtaining_vi_reference.html">Obtain a reference to the VI</a> whose connector pane you want to inspect or modify.

<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI uses the <a href="../glang/Open_VI_Reference.html">Open VI Reference</a> function to obtain a reference to a specific VI.</p></div>
	</li>
	<li>Use the <a href="../lvscript/VI_Connector_Pane058Reference.html">VI:Connector Pane:Reference</a> property to obtain a reference to the connector pane of the VI.
	</li>
	<li>Determine the connector pane pattern you want the VI to have.
		<p>Connector pane patterns are denoted by a pattern index between 4800 and 4835. By default, connector panes use pattern 4815.</p>
 <p>You can use one of the following approaches to identify which pattern index to use.</p>
			<ul>
				<li>Refer to the Connector Pane Pattern Reference VI located in the <span class="Monospace">labview\examples\Application Control\VI Scripting\Connector Pane</span> directory for a complete mapping of patterns to their indexes.
				<p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Scripting%5C%5CConnector%20Pane%5C%5CConnector%20Pane%20Pattern%20Reference.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open Connector Pane Pattern Reference VI&nbsp;</p>				
				</li>
				<li>View the Context Help of a VI that has a connector pane pattern that you want to use for the VI that you are modifying. If you <a href="../lvhowto/enabling_vi_scripting.html">display additional VI scripting information in the Context Help window</a>, the pattern index appears at the end of the path to the VI.
</li>
				<li>Use the <a href="../lvscript/ConnectorPane_Pattern.html">ConnectorPane:Pattern</a> property of another VI to programmatically obtain the pattern index of that VI.</li>
			</ul> 
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI enables the user to select the connector pane pattern at run time. Therefore, the scripting VI uses a control to determine the connector pane pattern.</p>
	<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;Because the <strong>Connector Pane Pattern</strong> control accepts any integer, this example should check the value of that control to ensure that it is within the 4800..4835 range of acceptable pattern indexes. For simplicity, the example omits this step.</td>
</tr>
</table></div>
	
	</li>
	
<li>Use the Connector Pane:Pattern property to set the connector pane to your chosen pattern.</li>

<li><a href="scripting_obtaining_object_references.html">Obtain references to the controls</a> that you want to assign to connector pane terminals.
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI uses the <a href="../lvprop/Pnl_Ctrls.html">Panel:Controls[]</a> property of the front panel of the target VI to obtain references to all front panel controls.</p></div>
	</li>
<li>Determine how you want to map these controls to the connector pane terminals.
		<p>Refer to the <a href="../lvdevconcepts/checklist.html">LabVIEW Style Checklist</a> for guidelines about assigning controls and indicators to connector panes that are visible to your users.</p>
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the only goal of the scripting VI is to assign all controls to a terminal. Therefore, the scripting VI does not have criteria for how to map the controls to the terminals.</p></div>
	</li>
	<li>Use the <a href="../lvscript/ConnPane_AssgCtrlToTerm.html">ConnectorPane:Assign Control To Terminal</a> method to assign each control to the desired terminal of the connector pane.
		<p>To identify the terminal index that corresponds to each terminal in your chosen pattern, refer to the Connector Pane Pattern Reference VI mentioned in step 3.</p>
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI iterates across the entire Panel:Controls[] array, assigning each control to the next terminal index of the connector pane. This approach does not require knowledge of specific terminal indexes because the scripting goal does not require the controls to be wired to the connector pane in a specific way.</p>
			<table class="Borderless">
				<tr>
					<td class="Icon"><img src="note.gif" alt="Note"></td>
					<td><strong>Note</strong>&nbsp;&nbsp;Because it is possible in the example for the chosen connector pane pattern to have fewer terminals than there are controls on the front panel, it is also possible for the ConnectorPane:Assign Control To Terminal method to return an error. Refer to the <a href="../lvhowto/scripting_configuring_connector_panes.html#bestpractices">Caveats and Recommendations</a> section of this topic for information about avoiding this error.</td>
				</tr>
			</table></div>
	</li>
	<li>Use the <a href="../glang/Close_LV_Object_Reference.html">Close Reference</a> function to close each open object reference when you are finished using it.
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI closes the reference to the front panel, the controls, the connector pane, and the target VI.</p></div>
	</li>
</ol>

<a name="bestpractices"></a><h2>Caveats and Recommendations</h2>
<ul>
	<li><strong>Use caution when you change a connector pane pattern that has pre-existing control assignments</strong>&#8212;When you replace a connector pane pattern with a different pattern, LabVIEW reassigns the controls that were previously assigned to terminals on the old pattern to terminals on the new pattern. However, the new assignments do not preserve the terminal indexes or relative locations from the old pattern. Therefore, you can rely only on knowledge of terminal assignments that you obtain after the most recent pattern change.</li>
	<li><strong>Ensure that the pattern of a connector pane has enough terminals to accommodate the terminal indexes that you plan to use</strong>&#8212;The Connector Pane:Assign Control to Terminal method returns an error if the pattern of the referenced connector pane does not have enough terminals to accommodate the terminal index that you wire to the method. Use the <a href="../lvscript/ConPane_NumCnction_Terms.html">ConnectorPane:Number of Connection Terminals</a> property of the relevant connector pane to verify that the connector pane has enough terminals for the terminal index that you want to use.</li>
<li><strong>Close all references that you open</strong>&#8212;An excessive number of open references negatively impacts the performance of a VI.  Read about <a href="../lvhowto/scripting_closing_references.html">closing VI and VI object references</a> for more performance details.</li>
</ul>


</body>
</html>

