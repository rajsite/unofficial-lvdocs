<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>Tutorial: Creating and Publishing a LabVIEW Web Service to the NI Web Server (Windows)</title>
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script>
</head>
<body bgcolor="#ffffff">

<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript>

<h1>Tutorial: Creating and Publishing a LabVIEW Web Service to the NI Web Server (Windows)</h1>
<p><strong>Parent Topic</strong>: <a href="../lvconcepts/ws_portal.html">Communicating with a LabVIEW Application from Web Clients</a></p>
<p class="Body">Complete the following steps to create, publish, and exchange data between a LabVIEW Web service and a web client, in this case, a web browser.</p>

<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif"></td>
<td>
<strong>Note</strong>&nbsp;&nbsp;LabVIEW Web services are available only in the LabVIEW Full Development System and the LabVIEW Professional Development System.
</td>
</tr>
</table>
<p class="Body">This tutorial contains the following sections:</p>
<ol>
<li><a href="#Creating_VIs_WS">Creating a Web Service</a></li>
<li><a href="#Debugging_WS">Testing and Debugging the Web Service</a></li>
<li><a href="#Configuring_WS">Configuring How Clients Access the Web Service</a></li>
<li><a href="#Deploying_WS">Publishing the Web Service to the NI Web Server</a></li>
<li><a href="#Accessing_WS">Accessing the Web Service with a Client</a></li>
</ol>


<a name="Creating_VIs_WS"></a><h2>Creating a Web Service</h2>
<p class="Body">Develop a Web service in a LabVIEW project to group together and configure the VIs and other files that make up the Web service. Complete the following steps to create a Web service project and two HTTP method VIs.</p>

<ol>
<li>Create a LabVIEW project to organize the Web service files. Save the project as <span class="Monospace">Tutorial.lvproj</span>. </li>
<li>Right-click <strong>My Computer</strong> and select <strong>New&#0187;Web Service</strong>. LabVIEW adds a Web service project item and folders under the target.
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;In this tutorial, you create a Web service and publish it on the host computer. You also can publish a Web service to a Real-Time (RT) target by creating a Web service project under the RT target in <strong>Project Explorer</strong>. If you want to publish your Web services to RT targets, you can use only the Application Web Server to host your Web services. Refer to <a href="../lvhowto/Build_Web_Service.html">Tutorial: Creating and Publishing a LabVIEW Web Service to the Application Web Server</a> for detailed instructions.</td>
</tr>
</table>
</li>
<li>Right-click the Web service project item <img src="noloc_env_ws_node.gif" />, select <strong>Rename</strong>, and name the Web service <span class="Monospace">TutorialService</span>. The project appears as follows:<br /><br />
<img src="loc_env_Add.gif">
</li>
<li>Right-click <strong>Web Resources</strong> and select <strong>New VI</strong> to create a new HTTP method VI, which is a VI that receives HTTP requests from clients and returns data to clients. LabVIEW opens a new VI from a template.
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;By default, an HTTP method VI returns data to clients via the connector pane. In this tutorial, the HTTP method VIs return the default JSON-formatted text responses. When you create an HTTP method VI outside this tutorial, you also can stream data to a client in a custom format, such as a customized HTML page or image data. Configure the output format type on the <a href="../lvdialog/ws_http_method_page.html">HTTP Method VI Settings</a> page of the <strong>Web Service Properties</strong> dialog box.
</td>
</tr>
</table></li>
<li>In the new VI, build the block diagram, front panel, and connector pane as shown in the following figures. <br /><br />

    <table class="Bordered">
    <tr>
    <th class="Bordered" align="center">Block Diagram</th>
    <th class="Bordered" align="center">Front Panel</th>
    <th class="Bordered" align="center">Connector Pane</th>
    </tr>
    <tr>
    <td class="Bordered"><img src="loc_bd_urlmapping.gif"></td>
    <td class="Bordered"><img src="loc_fp_url_map.gif"></td>
    <td class="Bordered"><img src="loc_term_url_map.gif"></td>
    </tr>
    </table>
	<br />
    
When you publish this VI as part of a Web service, a web client can send an HTTP request to invoke it. When invoked, this VI performs the following actions:
    <ul>
        <li>Receives the values of any controls assigned to the connector pane (<em>except</em>&nbsp;<strong>LabVIEW Web Service Request</strong>) from the HTTP request the client made. <strong>LabVIEW Web Service Request</strong> acts like a refnum by identifying the current HTTP request.</li>
        <li>Computes the sum of <strong>a</strong> and <strong>b</strong>.</li>
        <li>Returns the sum of those values to the client via the <strong>c</strong> indicator assigned to the connector pane.</li>
        <li>Executes the Read Request Variable VI and returns the query string the client included in the current HTTP request, which <strong>LabVIEW Web Service Request</strong> identifies.
            <table class="Borderless">
            <tr>
            <td class="Icon"><img src="tip.gif" alt="Tip"></td>
            <td><strong>Tip</strong>&nbsp;&nbsp;In a more complex Web service, you might use other VIs on the <a href="../lvcomm/Web_Services.html">Web Services</a> palette to enable features such as setting HTTP headers and authentication.</td>
            </tr>
            </table>
        </li>
    </ul>
</li>
	
	<li>Notice that each control and indicator appears on the connector pane. With the default <strong>Terminal</strong> output type, Web services can receive data from clients or send data to clients only through inputs and outputs assigned to the connector pane of an HTTP method VI.
<table class="Borderless">
<tr>
<td class="Icon"><img src="tip.gif" alt="Tip"></td>
<td><strong>Tip</strong>&nbsp;&nbsp;Assign recognizable names to each object. These names become part of the URL that web clients use to exchange data with the VI.</td>
</tr>
</table>
</li>
<li>Save the VI as <span class="Monospace">Add.vi</span>.</li>
<li>Select <strong>File&#0187;Save As</strong> and select <strong>Copy&#0187;Open additional copy</strong> in the dialog box that prompts. Ensure the <strong>Add copy to Tutorial.lvproj</strong> checkbox contains a checkmark, and then click <strong>Continue</strong>.</li>
<li>Save the new copy as <span class="Monospace">Subtract.vi</span>.</li>
<li>Open the block diagram of <span class="Monospace">Subtract.vi</span> and replace the Add function with the Subtract function. Rewire the controls and indicators.</li>
<li>Return to the project, right-click <strong>Web Resources</strong>, and select <strong>New Web Resource</strong>. Rename the new project item <span class="Monospace">AdditionalOperations</span>.</li>
<li>Drag <span class="Monospace">Subtract.vi</span> under the <strong>AdditionalOperations</strong> project item. Save the project, which should appear as in the following figure.<br /><br />
	<img src="loc_env_Subtract.gif"></li>
</ol>
<p class="Body">Notice the following features in the project tree:</p> 
<ul>
	<li>LabVIEW appends an HTTP request type to the name of each HTTP method VI, which by default is GET. You can change the type of HTTP request that clients send to a specific HTTP method VI later in this tutorial.</li>
	<li>The Web service project item <img src="noloc_env_ws_node.gif" /> also contains a <strong>Startup VIs</strong> folder. This tutorial does not use startup VIs, but you can find more information about them at the end of the tutorial.</li>
</ul>

<h3>Related Information</h3>
<p class="Body"><a href="../lvconcepts/WebServices_components.html">Components of a Web Service</a></p>
<p class="Body"><a href="../lvhowto/Assigning_Controls_and_Ind.html">Assigning Terminals to Controls and Indicators</a></p>
<p class="Body"><a href="../lvconcepts/ws_method_vis.html#output">Developing HTTP Method VIs: Choosing the Format of Output Data</a></p>
<p class="Body"><a href="../lvconcepts/WS_Configuring_Headers.html">Configuring HTTP Headers, Streaming, and Buffering</a></p>
<p class="Body"><a href="../lvconcepts/Using_LabVIEW_Projects.html">Managing a Project in LabVIEW</a></p>


<a name="Debugging_WS"></a><h2>Testing and Debugging the Web Service</h2>
<p class="Body">Before you publish the Web service to a target, you might want to test that the HTTP method VIs communicate with clients as expected. You can run the Web service on the NI Web Server directly from the LabVIEW project to allow a client to send requests to HTTP method VIs.</p>
<ol>
    <li>Right-click the Web service project item <img src="noloc_env_ws_node.gif" /> and select <strong>Start</strong>.</li>
	<li>If you are using the NI Web Server for the first time on your computer, complete the following steps to enable and configure the NI Web Server:
			<ol>
			<li>Click <strong>Configure NI Web Server</strong> in the <strong>Start Web Service</strong> dialog box to launch NI Web Server Configuration.</li>
			<li>For this tutorial, choose the <strong>Simple local access</strong> configuration preset and click <strong>Next</strong>.</li>
			<li>On the <strong>Authentication</strong> tab, select <strong>Log in using an admin user for server administration</strong> and create your password. Click <strong>Next</strong>.</li>
			<li>Click <strong>Finish</strong> to apply this configuration.</li>
			</ol>
	</li>
	<li>Switch back to the LabVIEW project and repeat step 1. The Web service is now running on the NI Web Server.</li>
    <li>Open <span class="Monospace">Add.vi</span>. Notice that the <strong>Run</strong> button indicates the VI is reserved for execution <img src="noloc_env_run_reserved.gif"> because LabVIEW loads the Web service and makes it available on the NI Web Server for communication with clients.</li>
    <li>Close <span class="Monospace">Add.vi</span>.</li>
    <li>Complete the following steps to get the URL that clients use to invoke <span class="Monospace">Add.vi</span>:
    <ol>
        <li>Right-click <span class="Monospace">Add.vi</span> and select <strong>Show Method URL</strong> to display the <a href="../lvdialog/ws_http_method_url_db.html">HTTP Method URL</a> dialog box.</li>
        <li>In the <strong>Available Servers</strong> pull-down menu, select the item that contains <strong>NI Web Server</strong>, and then click <strong>Copy URL</strong>.</li>
        <li>Close the dialog box.
		<table class="Borderless">
		<tr>
		<td class="Icon"><img src="note.gif" alt="Note"></td>
		<td><strong>Note</strong>&nbsp;&nbsp;The Web service does not respond to any requests from the client if the <strong>HTTP Method URL</strong> dialog box is open.</td>
		</tr>
		</table></li>
    </ol>
    </li>
    <li>Paste the URL from step 6 into a standard web browser and replace the <span class="Monospace">{value}</span> variables with numeric values, such as: <span class="Monospace">http://127.0.0.1:80/TutorialService/Add?b=2&amp;a=3</span>.
		<table class="Borderless">
		<tr>
		<td class="Icon"><img src="note.gif" alt="Note"></td>
		<td><strong>Note</strong>&nbsp;&nbsp;NI Web Server uses 80/443 as the default port in accordance with HTTP/HTTPS protocol. However, the port number might change if another application occupies the port. You can customize the port number in NI Web Server Configuration. Refer to <a href="javascript:WWW(WWW_NIWSConfig)">Configuring NI Web Server</a> for more information on server settings like authentication, port, and remote connections.</td>
		</tr>
		</table>
    </li>
    <li>Browse to the URL. <span class="Monospace">Add.vi</span> receives the HTTP request from the browser, computes the sum of the values for <strong>a</strong> and <strong>b</strong>, and returns a response with the name and output value of each indicator assigned to the connector pane of <span class="Monospace">Add.vi</span>. In this tutorial, the response is a JSON string, which is the default <strong>Terminal</strong> output format. Recall that <span class="Monospace">Add.vi</span> has two indicators assigned to its connector pane: <strong>c</strong> and <strong>value</strong>, whose values the HTTP method VI returns in the response.
	<p><span class="Monospace">{&quot;c&quot;:5,&quot;value&quot;:&quot;b=2&amp;a=3&quot;}</span></p>
	<table class="Borderless">
	<tr>
	<td class="Icon"><img src="note.gif" alt="Note"></td>
	<td><strong>Note</strong>&nbsp;&nbsp;If you notice unexpected behavior, you must stop the debugging session before you can edit the Web service files because you cannot edit the files while LabVIEW reserves them for execution. Right-click the Web service project item and select�<strong>Stop</strong>.</td>
	</tr>
	</table>
	</li>
<li>Repeat steps 6 and 7 for <span class="Monospace">Subtract.vi</span>, or update the URL from step 7 to reflect the unique URL mapping for <span class="Monospace">Subtract.vi</span>: <span class="Monospace">http://127.0.0.1:80/TutorialService/AdditionalOperations/Subtract?b=2&amp;a=3</span>.</li>
<li>Repeat step 8 for <span class="Monospace">Subtract.vi</span>.</li>
<li>Right-click the Web service project item and select <strong>Stop</strong>.</li>
</ol>

<h3>Related Information</h3>
<p class="Body"><a href="../lvhowto/ws_testing.html">Testing and Debugging a Web Service</a></p>
<p class="Body"><a href="../lvhowto/ws_setup_niws.html">Setting up the NI Web Server for Web Services</a></p>

<a name="Configuring_WS"></a><h2>Configuring How Clients Access the Web Service</h2>
<p class="Body">Web clients use URLs to exchange data with HTTP method VIs. Later in this tutorial, you will enter a specific URL in a web browser to send data directly to the controls on the connector pane of the HTTP method VIs.</p>

<p class="Body">Complete the following steps to define the URLs clients can use to access the HTTP method VIs:</p>
     <ol>
	    <li>Right-click the Web service project item <img src="noloc_env_ws_node.gif" /> and select <strong>Properties</strong> to display the <strong>Web Service Properties</strong> dialog box.</li>

	  <li>On the <a href="../lvdialog/ws_http_method_page.html">HTTP Method VI Settings</a> page, notice that HTTP method VIs from the <strong>Web Resources</strong> folder in the LabVIEW project appear in the table of Web service VIs. Further, notice how placing <span class="Monospace">Subtract.vi</span> under the <span class="Monospace">AdditionalOperations</span> project item affects the URL mapping compared to <span class="Monospace">Add.vi</span>.</li>
	<li>Select <span class="Monospace">Subtract.vi</span> in the table and notice the following features on the <strong>URL Mapping</strong> tab at the bottom of the page:
	<ul>
		<li>You can change the HTTP request type in the�<strong>Method</strong>�pull-down menu. Use the default <span class="monospace">GET</span> value for <span class="Monospace">Subtract.vi</span>.</li>
		<li>You can choose to disable the standard format LabVIEW uses to map a URL to the VI and instead customize the part of the URL that appears after the service name. For this tutorial, use the standard URL mapping and include the VI name.</li>
			<li>The <strong>URL</strong> field displays the base URL LabVIEW creates for the HTTP method VI. For example, for <span class="Monospace">Subtract.vi</span>, LabVIEW creates the default URL mapping <span class="monospace">/AdditionalOperations/Subtract</span>.<br /><br />
<img src="loc_env_ws_props.png" />

</li></ul>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;In a more complex Web service, you might use the remaining tabs on this page to configure the format that the VI returns output data to the web client, as well as security settings like privileges.</td>
</tr>
</table></li>
<li>Click <strong>OK</strong> to close the <strong>Web Service Properties</strong> dialog box.</li>
<li>Save <span class="Monospace">Tutorial.lvproj</span>.</li>
</ol>
<h3>Related Information</h3>
<p class="Body"><a href="../lvconcepts/ws_URL_mapping.html">Understanding URL Mappings and Query Strings in Web Services</a></p>

<a name="Deploying_WS"></a><h2>Publishing the Web Service to the NI Web Server</h2>
<p class="Body">You can publish the Web service you create to the NI Web Server. The NI Web Server is a production-grade web server that can host user-authored services, such as LabVIEW Web services, and SystemLink� services created by NI. The NI Web Server protects web applications against common web security threats, provides high scalability to many enterprise-grade data services, and allows device management. In this tutorial, you publish the web service by including it in an NI package and installing the package.</p>
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;You can also publish your Web service to the Application Web Server. Refer to <a href="../lvhowto/Build_Web_Service.html">Tutorial: Creating and Publishing a LabVIEW Web Service to the Application Web Server</a> for more details.</td>
</tr>
</table>

<p class="Body">Complete the following steps to publish the Web service to the NI Web Server running on the local computer through a package:</p>
<ol>
<li>Right-click the <strong>Build Specifications</strong> in the�<strong>Project Explorer</strong>�window and select�<strong>New&#0187;Package</strong> to launch the�<a href="../lvdialog/build_package_db.html">Package Properties</a> dialog box.</li>
<li>On the <a href="../lvdialog/build_package_info.html">Information</a> page, specify the location to build the package in the <strong>Package output directory</strong> text box.</li> 
<li>On the�<a href="../lvdialog/build_package_ws.html">Web Services</a>�page, place a checkmark in the <span class="Monospace">TutorialService</span> checkbox to include the Web service in the package.</li>
<li>Click <strong>Build</strong> and the <a href="../lvdialog/build_status.html">Build Status</a> dialog box appears.</li>
<li>When LabVIEW completes building the package, click <strong>Explore</strong> to open the destination directory where LabVIEW saves the package file (<span class="Monospace">.nipkg</span>).</li>
<li>Double-click the package to install it through the NI Package Manager. When the installation is complete, the Web service is published to the NI Web Server on the host computer.</li>
<li>Close the LabVIEW project. Published Web services run on the LabVIEW Runtime and do not depend on the LabVIEW Development System.</li>
</ol>
<h3>Related Information</h3>
<p class="Body"><a href="../lvconcepts/ws_distributing.html">Publishing Web Services</a></p>

<a name="Accessing_WS"></a><h2>Accessing the Web Service with a Client</h2>
<p class="Body">Complete the following steps to send data to the published Web service from a web browser via a URL:</p>
<ol>
<li>Paste the URL from step 7 in the <a href="#Debugging_WS">Testing and Debugging the Web Service</a> section into a standard web browser and replace the <span class="Monospace">{value}</span> variables with numeric values, such as: <span class="Monospace">http://127.0.0.1:80/TutorialService/Add?b=2&amp;a=3</span>.
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;If the client is located on a different system than where you publish the Web service, you must replace <span class="Monospace">127.0.0.1</span> with the actual IP address of the hosting system or the hostname you <a href="javascript:WWW(WWW_NIWSConfig)">customize in NI Web Server Configuration</a>.</td>
</tr>
</table>
</li>
<li>The browser returns a JSON response with the output values from each indicator assigned to the connector pane.</li>
</ol>

<h3>Related Information</h3>
<p class="Body"><a href="../lvconcepts/WS_send_data_URL.html">Sending Data to a Deployed Application Using URLs</a></p>


<a name="Next"></a><h2>Where to Go Next</h2>
<ul>
<li><a href="../lvconcepts/WebServices.html">Overview: Web-based Communication with a LabVIEW Application</a>&#8212;An overall introduction to LabVIEW Web Service</li>
<li><a href="../lvhowto/ws_publishing_package.html">Publishing a Web Service through a Package</a>&#8212;Include a Web service in an NI package, so that the Web service runs when you install the package.</li>
<li><a href="../lvhowto/ws_publishing_app.html">Publishing a Web Service through a Stand-Alone Application</a>&#8212;Include a Web service in a LabVIEW stand-alone application, so that the Web service runs when the application runs.</li>
<li><a href="../lvconcepts/ws_method_vis.html">Developing HTTP Method VIs</a> or <a href="../lvconcepts/ws_startup_vis.html">Developing Startup VIs to Initialize and Communicate with HTTP Method VIs</a>&#8212;Develop more complex HTTP method VIs, as well as startup VIs that run as part of a Web service application but do not exchange data with a web client.</li>
<li><a href="../lvhowto/WS_Static_Content.html">Integrating Static Content into a Web Service</a>&#8212;Publish static content such as HTML pages or images with a Web service.</li>
</ul>

<h3>Example Code</h3>
<p class="Body">Refer to the following LabVIEW projects for examples of using Web services:</p>
<ul>
<li><span class="Monospace">examples\Connectivity\Web Services\Weather Monitor\Web Services &mdash; Weather Monitor.lvproj</span>
<br><a href="javascript:openProj('examples%5C%5CConnectivity%5C%5CWeb%20Services%5C%5CWeather%20Monitor%5C%5CWeb%20Services%20-%20Weather%20Monitor.lvproj');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(1694);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</li>
</ul>
</body>
</html>