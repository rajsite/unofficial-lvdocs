<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>



<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<script src="common.js" type="text/javascript"></script>







<title>Creating Instrument Driver VIs</title>
</head>
<body bgcolor="#ffffff">

<noscript>
<p class="Body">JavaScript is disabled. <a href="../lvhelp/JavaScript_Disabled.html">Details</a></p>
<hr width="100%" noshade>
</noscript>

<h1>Creating Instrument Driver VIs</h1>
<p class="Body">You can use the <a href="../lvdialog/ID_VI.html">Instrument Driver VI Wizard</a> to create instrument driver VIs for an instrument driver project.</p>
<p class="Body">Complete the following steps to create an instrument driver VI using the Instrument Driver VI Wizard.</p>
<ol><li>Create or open an instrument driver project.<br/>You can <a href="../lvhowto/creating_instproj.html">create an instrument driver project</a> using the <a href="../lvdialog/IDproject.html">Create New Instrument Driver Project</a> wizard. You can search for and install existing instrument driver projects using the <a href="../lvdialog/id_finder.html">NI Instrument Driver Finder</a>.</li>
<li>Right-click a LabVIEW instrument driver project library (<span class="Monospace">.lvlib</span>) in the <a href="../lvconcepts/Using_LabVIEW_Projects.html">Project Explorer</a> window and select <strong>New&#0187;Instrument Driver VI</strong> from the shortcut menu to display the Instrument Driver VI Wizard.</li><li>On the <strong>Start</strong> page of the Instrument Driver VI Wizard, select one of the following options and click the <strong>Next</strong> button.
							<ul><li><strong>Create from an instrument driver template VI</strong>&#8212;Creates the instrument driver VI from a template VI.</li>
<li><strong>Copy from an existing VI</strong>&#8212;Copies and configures an existing instrument driver VI and its subVIs.</li>
<li><strong>Configure your own VI</strong>&#8212;Configures an instrument command, specifies how to parse a response, interacts with connected instruments, and generates the corresponding instrument I/O and string formatting/parsing code into a new instrument driver VI.</li>
<li><strong>Add a blank VI</strong>&#8212;Creates an instrument driver VI that contains only a VISA resource name control and indicator and an error cluster control and indicator.</li></ul></li>
<li>On the second page of the wizard:
<ul><li>If you selected <strong>Create from an instrument driver template VI</strong> on the <strong>Start</strong> page, select a VI from the available instrument driver VI templates on the <strong>Clone from Template</strong> page and click the <strong>Next</strong> button.</li>
<li>If you selected <strong>Copy from an existing VI</strong> on the <strong>Start</strong> page, click the <strong>Browse</strong> button on the <strong>Browse for VI</strong> page to navigate to and select the VI you want to add to the project and click the <strong>Next</strong> button.</li>
<li>If you selected <strong>Configure your own VI</strong> on the <strong>Start</strong> page, select <strong>Configuration VI</strong> or <strong>Measurement VI</strong> on the <strong>Select VI type</strong> page and click the <strong>Next</strong> button. Select <strong>Configuration VI</strong> to create a VI that sends a command to the instrument. Select <strong>Measurement VI</strong> to create a VI that sends a command to the instrument and then reads a response from the instrument.</li>
<li>If you selected <strong>Add a blank VI</strong> on the <strong>Start</strong> page, continue to step 6.</li></ul></li>
<li>If you selected <strong>Configure your own VI</strong> on the <strong>Start</strong> page, configure the <strong>Control setup</strong> page and click the <strong>Next</strong> button. Otherwise, continue to the next step.<br/>
<ol class="List-abc"><li>Type a command string to send to the instrument in the <strong>Command text with parameters in percents</strong> text box. Specify parameters in the command string by placing <span class="Monospace">%</span> characters around the parameter name. LabVIEW displays the parameter names you create in the <strong>Configure parameters</strong> list. For every parameter you create, LabVIEW adds a corresponding control to the front panel and connector pane of the final VI. </li><li>Select the appropriate data type for each parameter from the <strong>Data type</strong> pull-down menu. </li><li>Set a default value for each parameter in the numeric box next to the <strong>Data type</strong> pull-down menu.</li>
<li>Verify the configured command string in the <strong>Command preview</strong> text box.</li>
<li>If you selected <strong>Configuration VI</strong> on the <strong>Select VI type</strong> page, select the instrument from the pull-down menu in the <strong>Test the Command</strong> section. If you selected <strong>Measurement VI</strong> on the <strong>Select VI type</strong> page, click the <strong>Next</strong> button and select the instrument from the pull-down menu in the <strong>Test the Command</strong> section.</li>
<li>Click the <strong>Run Test</strong> button to test the command you configured. LabVIEW sends the command in the <strong>Command preview</strong> text box to the instrument and shows the number of bytes written to the instrument in the <strong>Bytes written</strong> box. If the command succeeds, the light turns a brighter green. If VISA returns an error, the light turns red. Click the <strong>Explain Error</strong> button to display the errors. If you selected <strong>Measurement VI</strong> on the <strong>Select VI type</strong> page, LabVIEW reads the response from the instrument and displays it in the <strong>Response</strong> text box. You can select the data type of the response in the <strong>Configure response data type</strong> section.</li></ol></li>
<li>On the <strong>VI Properties</strong> page, edit the VI name, path, icon, and description and click the <strong>Next</strong> button.</li><li>On the <strong>Summary</strong> page, review the information about the new VI and click the <strong>Finish</strong> button to add the instrument driver VI and any subVIs to the instrument driver project and open the VI. If you created the VI from a template VI or an existing VI, LabVIEW renames subVIs that have the same name but a different connector pane as an existing VI in the project library. LabVIEW does not copy subVIs that have the same name and the same connector pane as an existing VI in the project library. The new VI uses the existing VIs in the project library in place of any subVIs that LabVIEW did not add.</li></ol>


</body>
</html>