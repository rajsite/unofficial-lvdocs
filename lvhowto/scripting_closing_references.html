<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="common.js" type="text/javascript"></script><script src="dynamicjumps.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script><title>Closing References to VIs and VI Objects Using VI Scripting</title>
</head>
<body>
<h1>Closing References to VIs and VI Objects Using VI Scripting</h1>
<p><strong>Requires:</strong> <a href="enabling_vi_scripting.html">VI Scripting</a></p>
<p>All VI Scripting tasks require you to open references to the VIs and objects that you want to create, edit, or inspect. You create or open a reference when you use VIs, functions, properties, and methods that return a reference. As long as a reference remains open, LabVIEW cannot remove the corresponding VI or object from memory. Therefore, when a large number of references are open, a large number of VIs and objects are in memory, causing LabVIEW to perform more slowly and possibly preventing LabVIEW from creating new VIs and objects if no more memory is available. Thus, to help avoid these performance issues, close all references to VIs or objects that you open within a scripting VI.</p>

<p><a name="sideEffects"></a>Use the <a href="../glang/Close_LV_Object_Reference.html">Close References</a> function to close any references that you create or open. However, you cannot close references that LabVIEW closes as a side effect of the following actions:</p>
<table class="Bordered">
	<tr class="Bordered">
		<th class="Bordered">Action</th>
		<th class="Bordered">Side Effect</th>
	</tr>
	<tr class="Bordered">
		<td class="Bordered">Using the <a href="../lvscript/Generic_Delete.html">Generic:Delete</a> method</td>
		<td class="Bordered">Closes the reference to the object that you are deleting</td>
	</tr>
	<tr class="Bordered">
		<td class="Bordered">Using the <a href="../lvscript/GObject_Replace.html">GObject:Replace</a> method</td>
		<td class="Bordered">Closes the reference to the object that you are replacing</td>
	</tr>
	<tr class="Bordered">
		<td class="Bordered">Closing a reference to a VI</td>
		<td class="Bordered">May invalidate references to objects within the VI</td>
	</tr>
	<!--<tr>
		<td>Closing a reference to a Node object</td>
		<td>Invalidates references to terminals of the node</td>
	</tr>-->
</table>

<a name="whatYouNeed"></a><h2>What to Use</h2>
<p>This VI Scripting task requires the following objects:</p>
<table class="Usage">
	<col class="Object"/>
	<tr><td><a href="../glang/Close_LV_Object_Reference.html">Close Reference</a></td></tr>
	<tr><td><img src="noloc_bd_CloseReference.gif"></td></tr>
	<tr>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object709);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN></td><td> 
<SPAN title=" Find on the palette "><a href="javascript:findObject(object709);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
	</tr>
</table>

		
<a name="how"></a><h2>What to Do</h2>

<p><strong>Before you start: </strong>Open the Closing References VI in the <span class="Monospace">labview\examples\Application Control\VI Scripting\Managing References</span> directory for an example that illustrates each step of the following procedure.</p>
<a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Scripting%5C%5CManaging%20References%5C%5CClosing%20References.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open Example
<p>Expand the procedure for more information about this specific example.</p>


<input type="button" onclick="openAll()" value="Expand All"><input type="button" onclick="closeAll()" value="Collapse All">

<ol>
	<li>Identify all references to VIs and VI objects on the block diagram of the scripting VI.
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI opens a reference in the following places:</p>
			<ul>
				<li>Open VI Reference&#8212;Opens a reference to the target VI</li>
				<li>Traverse for GObjects&#8212;Opens a reference to each Function object in the target VI</li>
				<li>Function:Terminals[]&#8212;Opens references to all the terminals of each function</li>
				<li>Terminal:Connected Wire&#8212;Opens a reference to the wire that is connected to each terminal</li>
				<li>Wire:Terminals[]&#8212;Opens references to all the terminals of a wire</li>
				<li>Function:Replace&#8212;Opens a reference to the replacement function</li>
				<li>Function:Terminals[]&#8212;Opens references to all the terminals of the replacement function</li>
			</ul></div>
	</li>
	<li>Determine the last time that LabVIEW uses each reference. 
		<p>Consider the following issues when tracing the data flow of a reference:</p>
			<ul>
				<li>LabVIEW requires an open reference to a VI when you use a reference to any object within that VI.</li>
				<li>LabVIEW requires an open reference to a node when you use a reference to any terminal of that node.</li>			
			</ul>
		
<p class="expanded"><span class="expandable-underline">Example Details</span></p>	<div class="expandable-section-open"><p>In the example, the open references are last used in the following places:</p>
			<ul>
				<li>Target VI reference&#8212;At the end of the VI. LabVIEW uses this reference throughout the VI because the other open references are to objects within the target VI.</li>
				<li>Function references&#8212;After the Function:Replace method</li>
				<li>Function terminal references&#8212;After the Terminal:Connected Wire method</li>
				<li>Wire reference&#8212;After the Wire:Delete method</li>
				<li>Wire terminal references&#8212;After the Terminal:Connect Wire method</li>
				<li>Replacement function reference&#8212;After the Function:Terminals[] method</li>
				<li>Terminal references for replacement function&#8212;After the Terminal:Connect Wire method</li></ul></div>
	</li>
	<li>Wire each open reference to a <a href="../glang/Close_LV_Object_Reference.html">Close Reference</a> function soon after LabVIEW last uses the reference. Use the data flow provided by the error cluster to control when LabVIEW executes each Close Reference function. Beware of the <a href="#sideEffects">side effects</a> when closing references.
<p class="expanded"><span class="expandable-underline">Example Details</span></p>		<div class="expandable-section-open"><p>In the example, the scripting VI closes most references immediately after their final use. However, the example contains two unique cases where this is not possible:</p>
			<ul>
				<li>The Function:Replace method closes the reference to the function that it replaces. Therefore, the scripting VI does not need to close that reference after the Function:Replace method finishes executing.</li>
				<li>The Wire:Delete method closes the reference to the wire that it deletes. Therefore, the scripting VI cannot close that reference after the Wire:Delete method finishes executing.</li>
			</ul></div>
		
	</li>
</ol>



<a name="bestpractices"></a><h2>Caveats and Recommendations</h2>
<ul>
	<li><strong>Close object references before closing references to their containing VI</strong>&#8212;When you close a reference to a VI, all open references to objects within that VI might become invalid. Thus, you can safely close a VI reference only after you finish using both the VI reference and all references to objects within that VI.</li>
	<li><strong>Close references as soon as possible</strong>&#8212;An excessive number of open references causes LabVIEW to run more slowly. For small applications, this effect is negligible, but large applications will exhibit poorer performance. When you close references early in the program, you prevent them from lingering in memory unnecessarily.</li>
	<li><strong>Close references before the end of a VI when possible</strong>&#8212;LabVIEW automatically closes references in a VI that has finished executing, so you do not improve performance by closing references at the end of a VI.</li>
</ul>

<a name="examples"></a><h2>Additional Examples</h2>
<p class="Body">Refer to the Creating New VI From Scratch VI in the <span class="Monospace">labview\examples\Application Control\VI Scripting\Creating VIs</span> directory for another example of closing many references when using VI Scripting.</p>
<p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Scripting%5C%5CCreating%20VIs%5C%5CCreating%20New%20VI%20From%20Scratch.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(1443);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p>

</body>
</html>


