<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="STYLESHEET" type="text/css" href="minimal.css">
<link rel="STYLESHEET" type="text/css" href="expandable_tree.css"><script src="common.js" type="text/javascript"></script><script src="dynamicjumps.js" type="text/javascript"></script><script src="expandable_tree.js" type="text/javascript"></script><title>Asynchronously Calling a VI and Collecting the Results</title>
</head>
<body>
<h1>Asynchronously Calling a VI and Collecting the Results</h1>
<p>When you open a reference for a VI that you want to call asynchronously, you must decide whether you want to collect the results of the VI later. This topic describes how to start an asynchronous call-and-collect VI call and collect the results later. Other programming languages describe this usage model as fork-and-join. Alternatively, you can <a href="../lvhowto/acbr_call_and_forget.html">call a VI without collecting its results</a>.</p>


<a name="toUse"></a><h2>What to Use</h2>
<p>Use the following block diagram objects to dynamically start an asynchronous call to a VI and then collect the outputs of the VI at a later time:</p>
<table class="Usage">
	<col class="Object">
	<col class="Spacer">
	<col class="Object">
	<col class="Spacer">
	<col class="Object">
	<col class="Spacer">
	<col class="Object">
	<col class="Spacer">
	<col class="Object">
	<tr><td><a href="../lvconcepts/Dynamic_LoadCall_VIs.html#Call_By_Reference_Nodes_and_Strictly_Typed_VI_Refnums">Strictly Typed VI Reference</a></td>
		<td></td>
		<td><a href="../glang/Open_VI_Reference.html">Open VI Reference</a></td>
		<td></td>
		<td><a href="../glang/start_asynchronous_call.html">Start Asynchronous Call</a></td>
		<td></td>
		<td><a href="../glang/wait_on_asynchronous_call.html">Wait On Asynchronous Call</a></td>
		<td></td>
		<td><a href="../glang/Close_LV_Object_Reference.html">Close Reference</a></td>
	</tr>
	<tr><td><img src="noloc_icon_strictly_typed_reference.gif"></td>
	<td></td>
	<td><img src="noloc_icon_open_vi_reference.gif"></td>
	<td></td>
		<td><img src="noloc_icon_start_async_call.gif"></td>
		<td></td>
		<td><img src="noloc_icon_wait_on_async_call.gif"></td>
		<td></td>
		<td><img src="noloc_icon_close_reference.gif"></td>
	</tr>
	<tr><td><a href="../lvhowto/Create_Strict_Type_VI_Ref.html">Create</a></td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object708);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> </td><td>
<SPAN title=" Find on the palette "><a href="javascript:findObject(object708);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object5596);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> </td><td>
<SPAN title=" Find on the palette "><a href="javascript:findObject(object5596);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object5597);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> </td><td>
<SPAN title=" Find on the palette "><a href="javascript:findObject(object5597);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
		<td></td>
		<td><table><tr><td><SPAN title=" Add to the block diagram "><a href="javascript:placeObject(object709);"><img src="add.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Add</SPAN> </td><td>
<SPAN title=" Find on the palette "><a href="javascript:findObject(object709);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find</SPAN></td></tr></table>
		</td>
	</tr>
</table>


<a name="toDo"></a><h2>What to Do</h2>
<p>Create the following block diagram to asynchronously call a VI and then collect the results at a later time.</p>

<img src="loc_eps_acbr_call_and_collect.gif">
<p>The following list describes important details about the previous diagram.</p>
<table><tr><td><img src="noloc_eps_callout_1.gif"></td>
			<td><a href="../lvhowto/combining_options.html">Include the <span class="Monospace">0x100</span> flag</a> as part of the <strong>options</strong> input of the Open VI Reference function. This option flag causes LabVIEW to create a call-and-collect VI reference to be called asynchronously and to return its results at a later time.

<!-- begin-child: ../lvhowto/acbr_call_and_forget.html-->
<table class="Borderless">
<tr>
<td class="Icon"><img src="note.gif" alt="Note"></td>
<td><strong>Note</strong>&nbsp;&nbsp;The <cite>LabVIEW Help</cite> displays each of the <a href="../glang/Open_VI_Reference.html#options">option flags</a> for the Open VI Reference function in hexadecimal representation. Therefore, always <a href="../lvhowto/Changing_Format_and_Prec.html">change the display format</a> of the Numeric Constant input to hexadecimal to ensure that you are passing the correct value.</td>
</tr>
</table>
<!-- end-child: ../lvhowto/acbr_call_and_forget.html--></td>
		</tr>
	<tr>
		<td><img src="noloc_eps_callout_2.gif"></td>
		<td>The Wait On Asynchronous Call node is associated with a Start Asynchronous Call node that uses the same VI reference as an input.</td>
	</tr>
	<tr>
		<td><img src="noloc_eps_callout_3.gif"></td>
		<td>After the Start Asynchronous Call node calls the referenced VI, the rest of the calling block diagram continues executing without waiting for the referenced VI to complete.</td>
	</tr>
	<tr>
		<td><img src="noloc_eps_callout_4.gif"></td>
		<td>The Wait On Asynchronous Call node waits until the VI associated with its <strong>reference</strong> input finishes executing or until the node <a href="../glang/wait_on_asynchronous_call.html#timeout">times out</a>. At that time, the Wait On Asynchronous Call node returns the outputs of the referenced VI, and dataflow continues along its output wires.</td>
	</tr>
	<tr>
		<td><img src="noloc_eps_callout_5.gif"></td>
		<td><a name="closing"></a>Close each VI reference with the <a href="../glang/Close_LV_Object_Reference.html">Close Reference</a> function after you use it to collect the outputs of the referenced VI. When you close a call-and-collect VI reference, LabVIEW aborts all running instances of the VI and causes all associated Wait on Asynchronous Call nodes to return error 1026. This behavior differs from <a href="../lvhowto/acbr_call_and_forget.html#closing">closing call-and-forget VI references</a>.</td>
	</tr>
</table>


<a name="caveats"></a><h2>Caveats and Recommendations</h2>   
<ul><li><strong>Aborting VIs</strong>&#8212;Consider the following ramifications of aborting the VIs in this usage pattern:
	<ul>
		<li>If you abort the VI that opened the call-and-collect VI reference, LabVIEW automatically closes the reference and aborts all running instances of the VI.</li>
		<li>If you abort a specific instance of a call-and-collect VI reference, exactly one Wait On Asynchronous Call node returns an error indicating that the called VI aborted. All other Wait On Asynchronous Call nodes that are waiting on calls to the same VI reference continue waiting.</li>
		<li>If you call the <a href="../lvprop/VI_Abort_VI.html">Abort</a> method on a call-and-collect VI reference, LabVIEW aborts all currently running instances of the VI. A corresponding number of Wait On Asynchronous Call nodes return errors.</li>
	</ul>
</li>
<li>When the VI that opened the call-and-collect VI reference finishes executing, LabVIEW automatically closes the reference and aborts all running instances of the VI.</li>
<li>If you start multiple asynchronous calls to the same VI reference, you cannot directly identify which VI call returns its outputs to a specific Wait On Asynchronous Call node. <a href="../lvconcepts/asynchronous_vi_calls.html#pool">Assign an identifier to a VI call</a> if you need to know which instance of the VI returned.</li>
</ul>

<a name="multiple"></a><h2>Variation: Collecting Outputs from Multiple Calls to Unique VI References</h2>
<p>The following block diagram provides a template for calling multiple VIs asynchronously and then collecting their outputs. Because each asynchronous call is associated with a unique VI reference, each Wait On Asynchronous Call node waits for a specific VI call to finish. This template is particularly useful for creating user interfaces with subpanels whose contents represent the front panels of separate subVIs.</p>
<img src="loc_bd_acbr_join_loops.gif">

<a name="examples"></a><h2>Examples</h2>
<p class="Body">Refer to the Asynchronous Call and Collect VI in the <span class="Monospace">labview\examples\Application Control\VI Server\Asynchronous Call By Reference</span> directory for an example of asynchronously calling a VI and collecting its results later.</p>
<p class="Body"><a href="javascript:openVI('examples%5C%5CApplication%20Control%5C%5CVI%20Server%5C%5CAsynchronous%20Call%20By%20Reference%5C%5CAsynchronous%20Call%20and%20Collect.vi');"><img src="open.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Open example&nbsp;<a href="javascript:findExamples(3072);"><img src="find.gif" border="0" style="padding-bottom: 4px; vertical-align: middle"></a>&nbsp;Find related examples</p>

</body>
</html>
